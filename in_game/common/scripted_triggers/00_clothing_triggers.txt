# CORE TRIGGERS

portrait_clothing_trigger = {
	gfx_culture_applicable = $CULTURE_FLAG$
}

portrait_religion_clothing_trigger = {
	gfx_culture_applicable = $RELIGION_FLAG$
}

# SITUATIONAL TRIGGERS

portrait_is_hre_elector_trigger = {
	trigger_if = {
		limit = { exists = this } # To check if this is an actual character
		AND = {
			is_ruler = yes
			any_ruling_countries = {
				government_type = government_type:monarchy
				country_rank_level >= 2 # duchy or above
				exists = international_organization:hre
				has_special_status_in_international_organization = {
					type = special_status:elector
					international_organization = international_organization:hre
				}
			}
		}
	}
}

portrait_is_ruler_of_trigger = {
	trigger_if = {
		limit = { exists = this } # To check if this is an actual character
		OR = {
			AND = {
				any_ruling_countries = { tag = $COUNTRY$ }
				is_ruler = yes
			}
			AND = {
				any_ruling_countries = { tag = $COUNTRY$ }
				is_alive = no
			}
		}
	}
}

portrait_cannot_wear_armor_trigger = {
	# Will remove armor and helmet if true
	OR = {
		# Various reasons from being blocked
		is_adult = no
		modifier:blocked_from_being_leader = yes
		is_religious_figure = yes

		# Clergy in Catholic Military Orders
		AND = {
			portrait_clergy_trigger = { RELIGION_GFX = catholic_gfx }
			NOT = { employer ?= { has_reform = government_reform:military_order_reform } }
		}

		# Clergy Estate but Military Orders
		AND = {
			has_estate = estate_type:clergy_estate
			any_ruling_countries = {
				NOT = { has_reform = government_reform:military_order_reform }
			}
		}

		# Ruler of Theocracy but Military Orders
		AND = {
			is_ruler = yes
			owner = {
				government_type = government_type:theocracy
				NOT = { has_reform = government_reform:military_order_reform }
			}
		}
	}
}

portrait_wear_armor_trigger = {
	exists = this
	NOT = { portrait_cannot_wear_armor_trigger = yes }
	OR = {
		is_general = yes
		is_mercenary_leader = yes
		AND = {
			has_trait_category = general
			NOR = {
				has_trait = unsuited_for_army_command
				has_trait = unsuited_for_naval_command
			}
		}
		any_ruling_countries = {
			OR = {
				AND = {
					has_reform = government_reform:military_order_reform
					portrait_religion_clothing_trigger = { RELIGION_FLAG = western_christian_gfx }
				}
				country_type = army
			}
		}
		AND = {
			mil > 75
			employer ?= {
				OR = {
					AND = {
						has_reform = government_reform:military_order_reform
						portrait_religion_clothing_trigger = { RELIGION_FLAG = western_christian_gfx }
					}
					country_type = army
				}
			}
		}
	}
}

portrait_wear_helmet_trigger = {
	exists = this
	NOR = { 
		portrait_cannot_wear_armor_trigger = yes
		any_ruling_countries = { has_reform = government_reform:military_order_reform }
	}
	OR = {
		is_general = yes		
		is_mercenary_leader = yes
		any_ruling_countries = { country_type = army }
	}
}

portrait_muslim_trigger = {
	trigger_if = {
		limit = { 
			portrait_religion_clothing_trigger = { RELIGION_FLAG = muslim_gfx }
			gfx_culture_applicable = european_gfx
		}
		portrait_$RANK$_trigger = { CULTURE_GFX = european_gfx }
	}
	trigger_else_if = {
		limit = { 
			portrait_religion_clothing_trigger = { RELIGION_FLAG = muslim_gfx }
			gfx_culture_applicable = african_gfx
		}
		portrait_$RANK$_trigger = { CULTURE_GFX = african_gfx }
	}
	trigger_else_if = {
		limit = { 
			portrait_religion_clothing_trigger = { RELIGION_FLAG = muslim_gfx }
			gfx_culture_applicable = east_african_gfx
		}
		portrait_$RANK$_trigger = { CULTURE_GFX = east_african_gfx }
	}
	trigger_else_if = {
		limit = { 
			portrait_religion_clothing_trigger = { RELIGION_FLAG = muslim_gfx }
			gfx_culture_applicable = indian_gfx
		}
		portrait_$RANK$_trigger = { CULTURE_GFX = indian_gfx }
	}
	trigger_else_if = {
		limit = { 
			portrait_religion_clothing_trigger = { RELIGION_FLAG = muslim_gfx }
			gfx_culture_applicable = north_american_gfx
		}
		portrait_$RANK$_trigger = { CULTURE_GFX = north_american_gfx }
	}
	trigger_else_if = {
		limit = { 
			portrait_religion_clothing_trigger = { RELIGION_FLAG = muslim_gfx }
			gfx_culture_applicable = south_american_gfx
		}
		portrait_$RANK$_trigger = { CULTURE_GFX = south_american_gfx }
	}
	trigger_else_if = {
		limit = { 
			portrait_religion_clothing_trigger = { RELIGION_FLAG = muslim_gfx }
			gfx_culture_applicable = east_asian_gfx
		}
		portrait_$RANK$_trigger = { CULTURE_GFX = east_asian_gfx }
	}
	trigger_else = { always = no }
}

portrait_abrahamic_african_trigger = {
	trigger_if = {
		limit = { 
			portrait_religion_clothing_trigger = { RELIGION_FLAG = abrahamic_gfx }
			gfx_culture_applicable = african_gfx
		}
		portrait_$RANK$_trigger = { CULTURE_GFX = african_gfx }
	}
	trigger_else = { always = no }
}

## SOCIAL RANKS
portrait_commoner_trigger = {
	trigger_if = {
		limit = { exists = this }
		portrait_clothing_trigger = { CULTURE_FLAG = $CULTURE_GFX$ }
		OR = {
			has_estate = estate_type:peasants_estate
			has_estate = estate_type:tribes_estate
		}
	}
}

portrait_low_nobility_trigger = {
	trigger_if = {
		limit = { exists = this }
		portrait_clothing_trigger = { CULTURE_FLAG = $CULTURE_GFX$ }
	}
}

portrait_high_nobility_trigger = {
	trigger_if = { # Spouse
		limit = { 
			exists = this
			is_ruler = no
			is_married = yes
		}
		any_spouse ?= {
			is_alive = yes
			is_ruler = yes
			any_ruling_countries = { country_rank_level = 2 }
		}
		portrait_clothing_trigger = { CULTURE_FLAG = $CULTURE_GFX$ }
	}
	trigger_else_if = { # Child
		limit = { 
			exists = this
			is_ruler = no
			is_adult = no
		}
		any_parent = {
			any_ruling_countries = { country_rank_level >= 2 } # all children of dukes and above will wear high nobility child clothing unless they are rulers
		}
		portrait_clothing_trigger = { CULTURE_FLAG = $CULTURE_GFX$ }
	}
	trigger_else_if = { # Ruler
		limit = {
			exists = this
		}
		any_ruling_countries = {
			country_rank_level = 2
			NOR = {	
				government_type = government_type:theocracy
				is_leader_of_international_organization = international_organization:hre
			}
		}
		NOR = {
			any_ruling_countries = { country_rank_level > 2	} # makes sure that this is the highest title
			has_estate = estate_type:clergy_estate
		}
		portrait_clothing_trigger = { CULTURE_FLAG = $CULTURE_GFX$ }
	}
	trigger_else = { always = no }
}

portrait_clergy_trigger = {
	trigger_if = {
		limit = { exists = this }
		portrait_religion_clothing_trigger = { RELIGION_FLAG = $RELIGION_GFX$ }
		OR = {
			has_estate = estate_type:clergy_estate
			is_religious_figure = yes
			AND = {
				is_ruler = yes
				any_ruling_countries = { government_type = government_type:theocracy }
			}
		}
		NOT = {
			any_ruling_countries = {
				OR = {
					has_reform = government_reform:military_order_reform
					government_type = government_type:monarchy
					government_type = government_type:republic
				}
			}
		}
	}
}

portrait_royalty_trigger = {
	trigger_if = { # Spouse
		limit = { 
			exists = this
			is_ruler = no
			is_married = yes
		}
		any_spouse ?= {
			is_alive = yes
			is_ruler = yes
			any_ruling_countries = { country_rank_level = 3 }
		}
		portrait_clothing_trigger = { CULTURE_FLAG = $CULTURE_GFX$ }
	}
	trigger_else_if = { # Ruler
		limit = { 
			exists = this
		}
		any_ruling_countries = {
			OR = {
				country_rank_level = 3
				any_international_organizations_member_of = {
					international_organization_type = international_organization_type:high_kingship
					exists = leader_country
					leader_country ?= prev
				}
			}
			NOT = { government_type = government_type:theocracy }
		}
		portrait_clothing_trigger = { CULTURE_FLAG = $CULTURE_GFX$ }
	}
	trigger_else = { always = no }
}

portrait_imperial_trigger = {
	trigger_if = { # Spouse
		limit = {
			exists = this
			is_ruler = no
			is_married = yes
		}
		any_spouse ?= {
			is_alive = yes
			is_ruler = yes
			any_ruling_countries = {
				OR = {
					country_rank_level = 4
					is_leader_of_international_organization = international_organization:hre
				}
			}
		}
		portrait_clothing_trigger = { CULTURE_FLAG = $CULTURE_GFX$ }
	}
	trigger_else_if = { # Ruler
		limit = {
			exists = this
		}
		any_ruling_countries = {
			OR = {
				country_rank_level = 4
				is_leader_of_international_organization = international_organization:hre
			}
		}
		portrait_clothing_trigger = { CULTURE_FLAG = $CULTURE_GFX$ }
	}
	trigger_else = { always = no }
}
