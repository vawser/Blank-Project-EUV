ciompi_revolt = {

	image = "gfx/interface/illustrations/disaster/ciompi_revolt.dds"
	
	monthly_spawn_chance = monthly_spawn_chance_very_high

	can_start = {
		tag = FLO
		OR = {
			produced_in_country:fine_cloth > 0
			produced_in_country:wool > 0
		}
		OR = {
			AND = {
				"estate(estate_type:burghers_estate)" = { estate_tax_rate > 0.25 }
				"estate(estate_type:peasants_estate)" = { estate_tax_rate > 0.25 }
			}
			AND = {
				estate_satisfaction:burghers_estate <= 0.6
				estate_satisfaction:peasants_estate <= 0.6
			}
		}
		stability < 30
		has_any_active_disaster = no
		custom_tooltip = {
			text = had_csd_disaster_variable_tt
			NOT = { has_variable = concluded_ciompi_revolt_variable }
		}
        NOT = { has_reform = government_reform:peasant_republic_reform }
	}
	

	can_end = {
		ciompi_revolt_end_trigger = yes
	}
	modifier = {
		burghers_estate_target_satisfaction = medium_permanent_target_satisfaction_penalty
		peasants_estate_target_satisfaction = medium_permanent_target_satisfaction_penalty
		global_wool_output_modifier = -0.2
		global_silk_output_modifier = -0.2
		global_fine_cloth_output_modifier = -0.2
	}
	
	on_start = {
		trigger_event_non_silently = ciompi_revolt.1 #The Ciompi Revolt
	}
	on_end = {
		set_variable = concluded_ciompi_revolt_variable
		trigger_event_non_silently = ciompi_revolt.8 #The End of the Ciompi Revolt
	}
	
	on_monthly = {

		random_list = {
			13 = { custom_tooltip = an_event_occurs_tt }
			87 = { custom_tooltip = no_event_occurs_tt }
		}

		hidden_effect = {
			random_list = {
				25 = { trigger_event_non_silently = ciompi_revolt.2 }
				25 = { trigger_event_non_silently = ciompi_revolt.3 }
				25 = { trigger_event_non_silently = ciompi_revolt.4 }
				25 = { trigger_event_non_silently = ciompi_revolt.5 }
				25 = { trigger_event_non_silently = ciompi_revolt.6 }
				25 = { trigger_event_non_silently = ciompi_revolt.7 }
				1000 = { custom_tooltip = no_event_occurs_tt }
			}
		}
		
	}
}