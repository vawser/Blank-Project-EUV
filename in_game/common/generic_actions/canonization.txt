# scope:actor = country, scope:recipient = religion
canonize = {
	type = religious

	sound = UI_action_religion_generic
	
	ai_tick = monthly
	ai_tick_frequency = 24
	automation_tick = monthly
	automation_tick_frequency = 6

	automation_tick = monthly
	automation_tick_frequency = 12
	player_automated_category = religiousdoctrines

	
	potential = {
		scope:actor.religion = {
			has_canonization = yes
		}
	}

	allow = {
	}
	
	price = price:canonize

	select_trigger = {
		looking_for_a = religion
		source = actor
		target_flag = recipient
		name = "choose_religion"
		column = {
			data = name
		}
	}

	select_trigger = {
		looking_for_a = character
		source = actor
		target_flag = target
		source_flags = include_dead
		name = "canonize_select_character"
		none_available_msg_key = "canonize_no_characters"
		column = {
			data = character_info
		}
		visible = {
			is_alive = no
			religion = scope:recipient
			not = { is_saint_of = scope:recipient }
		}
	}

	effect = {
		if = {
			limit = {
				exists = scope:target
			}
			scope:target = {
				make_saint = scope:actor
			}
			scope:actor = {
				add_prestige = {
					value = { 
						value = scope:target.total_abilities
						divide = 15
					}
				}
				add_legitimacy = {
					value = { 
						value = scope:target.total_abilities
						divide = 15
					}
				}
				add_estate_satisfaction = { type = estate_type:clergy_estate
					value = { 
						value = scope:target.total_abilities
						divide = 1500
					}
				}
			}
		}
	}

	ai_will_do = {
		add = -100
		
		# Bonus is multiplied by how good their attributes are
		add = {
			if = {
				limit = {
					exists = scope:target
				}
				value = scope:target.total_abilities
			}
		}
	}
}
