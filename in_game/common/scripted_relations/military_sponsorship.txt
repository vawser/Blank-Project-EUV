military_sponsorship =  {
	type = diplomacy
	relation_type = oneway	
	break_on_war = yes
	uses_diplo_capacity = receiving
	receiving_color = rgb { 60 120 0 }
	giving_color = rgb { 40 100 0 }
    institution_spread_to_second = monthly_institution_spread_weak
	gold_to_second = {
		value = scope:first.monthly_income_trade_and_tax
		multiply = 0.025
		max = {
			value = 0.1
			add = scope:second.monthly_income_trade_and_tax
		}
	}
	relation_type_for_ai = friendly
	category = {
		offer = CATEGORY_ECONOMY_ACTIONS
		request = CATEGORY_ECONOMY_ACTIONS
		cancellation = CATEGORY_ECONOMY_ACTIONS
		break = CATEGORY_ECONOMY_ACTIONS
	}

	visible = {
		scope:actor = {
			is_subject = no
			modifier:target_of_military_sponsorships = no
		}
		scope:recipient = {
			is_subject = no
			modifier:target_of_military_sponsorships = yes
		}
		scope:actor.religion = scope:recipient.religion
	}

	offer_enabled = {
		trigger_if = {
			limit = {
				scope:actor = { modifier:target_of_military_sponsorships = yes }
			}
			scope:recipient = { modifier:target_of_military_sponsorships = no }
		}
		trigger_if = {
			limit = {
				scope:actor = { modifier:target_of_military_sponsorships = no }
			}
			scope:recipient = { modifier:target_of_military_sponsorships = yes }
		}
		scope:recipient = {
			religion = scope:actor.religion
			not = {
				giving_scripted_relation = {
					type = relation_type:block_foreign_building
					target = scope:actor
				}
			}
		}
	}

	offer_effect = {
		if = {
			limit = {
				country_exists = c:PAP
				scope:actor = {
					not = { tag = PAP }
				}
			}
			c:PAP = {
				add_opinion = {
					target = scope:actor
					modifier = opinion_sponsoring_military_order
				}
			}
		}
	}
	cancel_effect = {
		if = {
			limit = {
				scope:actor = { not = { tag = PAP } }
				country_exists = c:PAP
			}
			c:PAP = {
				remove_opinion = {
					target = scope:actor
					modifier = opinion_sponsoring_military_order
				}
			}
		}
	}
	break_effect = {
		if = {
			limit = {
				scope:actor = { not = { tag = PAP } }
				country_exists = c:PAP
			}
			c:PAP = {
				remove_opinion = {
					target = scope:actor
					modifier = opinion_sponsoring_military_order
				}
			}
		}
	}
	
	will_expire_trigger = {
		OR = {
			scope:actor = {
				OR = {
					giving_scripted_relation = {
						type = relation_type:block_foreign_building
						target = scope:actor
					}
					not = { religion = scope:recipient.religion }
					modifier:target_of_military_sponsorships = yes
				}
			}
			scope:recipient = {
				OR = {
					not = { modifier:target_of_military_sponsorships = yes }
					not = { religion = scope:actor.religion }
				}
			}
		}
	}
	wants_to_give_diplo_chance = {
        base = -60
        #not_10_trust = -100
        trust_in_actor = 1
        positive_opinion = 0.5
        negative_opinion = -1
        border_distance = -0.01
        strategic_interest = 1
        common_threat = 3
        relative_strength = 40
		too_many_loans = -1000
	}
	wants_to_give = {
		if = {
			limit = {
				scope:recipient = {
					modifier:target_of_military_sponsorships = yes
				}
			}
			add = {
				desc = "DIPLOREASON_GOOD_FOR_US"	#An order should always say yes to it
				value = 100
			}
		}
		else = {
			add = {
				desc = "THEIR_OPINION_TOOLTIP"
				value = "scope:recipient.opinion(scope:actor)"
				divide = 2
			}
			add = {
				desc = "DIPLOREASON_DIPLOMATIC_REPUTATION"
				scope:actor = {
					value = modifier:diplomatic_reputation
					multiply = 5
				}
			}
			add = {
				desc = "DISTANCE_TO_TARGET"
				scope:recipient = {
					value = "border_distance_to(scope:actor)"
					multiply = -0.02
				}
			}
			if = {
				limit = {
					scope:recipient = {
						any_neighbor_country = {
							expected_army_size >= scope:recipient.expected_army_size
							NOT = { religion = scope:recipient.religion }
							NOT = { is_subject_of = scope:recipient }
							NOT = { is_subject_of = scope:actor }
							NOT = { is_allied_with = { target = scope:recipient } }
						}
					}
				}
				add = {
					desc = "THEY_THREATENED_BY_RELIGIOUS_ENEMIES"
					add = 50
				}
			}
		}
		add = {
			desc = "game_concept_rival"
			if = {
				limit = {	
					scope:recipient = { 
						is_rival_of = scope:actor 
					}
				}
				value = -1000
			}
		}
		add = {
			desc = "WOULD_PUT_US_INTO_DEFICIT"
			if = {
				limit = {	
					scope:recipient = {
						monthly_balance < {
							value = scope:recipient.monthly_income_trade_and_tax
							multiply = 0.05
							max = scope:actor.monthly_income_trade_and_tax
						}
					}
				}
				value = -1000
			}
		}
	}
	wants_to_receive = {
		if = {
			limit = {
				scope:recipient = {
					modifier:target_of_military_sponsorships = yes
				}
			}
			add = {
				desc = "DIPLOREASON_GOOD_FOR_US"	#An order should always say yes to it
				value = 100
			}
		}
		else = {
			add = {
				desc = "THEIR_OPINION_TOOLTIP"
				value = "scope:recipient.opinion(scope:actor)"
				divide = 2
			}
			add = {
				desc = "DIPLOREASON_DIPLOMATIC_REPUTATION"
				scope:actor = {
					value = modifier:diplomatic_reputation
					multiply = 5
				}
			}
			add = {
				desc = "DISTANCE_TO_TARGET"
				scope:recipient = {
					value = "border_distance_to(scope:actor)"
					multiply = -0.02
				}
			}
			if = {
				limit = {
					scope:recipient = {
						any_neighbor_country = {
							expected_army_size >= scope:recipient
							NOT = { religion = scope:recipient.religion }
							NOT = { is_subject_of = scope:recipient }
							NOT = { is_subject_of = scope:actor }
							NOT = { is_allied_with = { target = scope:recipient } }
						}
					}
				}
				add = {
					desc = "THEY_THREATENED_BY_RELIGIOUS_ENEMIES"
					add = 50
				}
			}
		}
		add = {
			desc = "game_concept_rival"
			if = {
				limit = {	
					scope:recipient = { 
						is_rival_of = scope:actor 
					}
				}
				value = -1000
			}
		}
	}
}
