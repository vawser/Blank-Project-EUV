lesson_basics = {
	chain = lesson_chain_basics
	start_automatically = no
	delay = 0
	gui_tag = "tutorial_basics"
	
	# Welcome to Caesar
	lesson_basics_welcome = {
		text = "lesson_welcome_desc"
		force_pause_game = yes
		animation = center

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_camera
		}
		effect = {
			hidden_effect = {
				close_all_views = yes

				set_collection_pin = {
					collection = outliner
					key = agenda
					value = yes
				}
				
				set_tutorial_var = tutorial_header

				set_tutorial_var = {
					name = intro_hide_ui_0
					value = 1
				}
				set_tutorial_var = {
					name = intro_hide_ui_1
					value = 1
				}
				set_tutorial_var = {
					name = intro_hide_ui_2
					value = 1
				}
				set_tutorial_var = {
					name = intro_hide_ui_3
					value = 1
				}
				set_tutorial_var = {
					name = intro_hide_ui_4
					value = 1
				}
				set_tutorial_var = {
					name = intro_hide_ui_5
					value = 1
				}
				set_tutorial_var = {
					name = intro_hide_ui_6
					value = 1
				}
				set_tutorial_var = {
					name = intro_hide_ui_7
					value = 1
				}
				set_tutorial_var = {
					name = intro_hide_ui_8
					value = 1
				}
			}
		}
	}

	# Camera and Controls 
	lesson_basics_camera = {
		text = "lesson_basics_camera_desc"
		# animation = right
		force_pause_game = yes
		gui_tag = "tutorial_camera"
		
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_welcome
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_nested_tooltips
		}
		effect = {
			add_gold = 100
		}
	}

	# Nested tooltips!
	lesson_basics_nested_tooltips = {
		text = "lesson_basics_nested_tooltips_desc"
		force_pause_game = yes
		animation = center

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_camera
		}
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_nested_tooltips_complete
			trigger = {
				custom_tooltip = {
					text = "lesson_basics_tooltips_in_tooltips_hover_word"
					is_tooltip_with_name_open = GameConceptTooltipDefault
				}
				custom_tooltip = {
					text = "lesson_basics_nested_tooltips_continue"
					current_tooltip_depth >= 2
				}
			}
		}
	}

	# Nested tooltips - Done!
	lesson_basics_nested_tooltips_complete = {
		text = "lesson_basics_nested_tooltips_desc"
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_camera
		}
		gui_transition = {
			button_id = "repeat"
			button_text = "tutorial_lesson_button_repeat_step"
			target = lesson_basics_nested_tooltips
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_your_nation
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_tooltips_in_tooltips_hover_word"
				}
				custom_tooltip = {
					text = "lesson_basics_nested_tooltips_continue"
				}
			}
		}
	}

	# You play as The Spirit of the Nation! 
	lesson_basics_your_nation = {
		text = "lesson_basics_your_nation_desc"
		force_pause_game = yes
		highlight_widget = "intro_highlight_1"

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_nested_tooltips
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_top_bar
		}
		effect = {
			set_tutorial_var = intro_hide_ui_2
		}
	}

	# There's stuff in the top bar...
	lesson_basics_top_bar = {
		text = "lesson_basics_top_bar_desc"
		force_pause_game = yes
		highlight_widget = "HUD TopBar"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_your_nation
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_estates
		}

		effect = {
			set_tutorial_var = intro_hide_ui_3
		}
	}
	
	# Like Estates!
	lesson_basics_estates = {
		text = "lesson_basics_estates_desc"
		force_pause_game = yes
		highlight_widget = "Top Bar Section 1"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_top_bar
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_resources
		}
	}

	# And Resources!
	lesson_basics_resources = {
		text = "lesson_basics_resources_desc"
		force_pause_game = yes
		highlight_widget = "Top Bar Section 2"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_estates
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_time_and_research
		}
		effect = {
			set_tutorial_var = {
				name = intro_hide_ui_5
				value = 1
			}
		}
	}

	# Oh, and the game plays out in real time.
	lesson_basics_time_and_research = {
		text = "lesson_basics_time_and_research_desc"
		force_pause_game = yes
		highlight_widget = "Top Bar Section 3"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_resources
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_wrap_up_0
		}
		effect = {
			set_tutorial_var = intro_hide_ui_5

			set_tutorial_var = {
				name = intro_hide_ui_4
				value = 1
			}
			set_tutorial_var = {
				name = intro_hide_ui_0
				value = 1
			}

			close_all_views = yes
		}
	}

	# There's more stuff to look at in the top left! 
	lesson_basics_wrap_up_0 = {
		text = "lesson_basics_wrap_up_0_desc"
		force_pause_game = yes
		highlight_widget = "tabs_buttons"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_time_and_research
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_wrap_up_2
		}
		effect = {
			set_tutorial_var = intro_hide_ui_4
		}
	}

	# Hints
	lesson_basics_wrap_up_2 = {
		text = "lesson_basics_wrap_up_2_desc"
		animation = "center"
		force_pause_game = yes
		highlight_widget = "button_hints"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_wrap_up_0
		}
		
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_0
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_open_hints"
					is_widgetid_open = hints_lateralview
				}
			}
		}
		effect = {
			close_all_views = yes
			set_tutorial_var = intro_hide_ui_6
		}
	}

	# Core Loop start
	lesson_core_loop_0 = {
		text = "lesson_core_loop_0_desc"
		force_pause_game = yes

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_wrap_up_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_1
		}
		effect = {
			close_all_views = yes
		}
	}

	# Budget 1
	lesson_core_loop_1 = {
		text = "lesson_core_loop_1_desc"
		force_pause_game = yes
		highlight_widget = "economy_tab_button"
        highlight_widget = "tab_balance"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_0
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_2
			enabled = {
				custom_tooltip = {
						text = "lesson_admin_open_economy"
						OR = {
							is_widgetid_open = economy_lateralview
							is_widgetid_open = trade_overview
						}
					}
				custom_tooltip = {
					text = "lesson_admin_open_balance"
					is_widgetid_open = economy_lateralview
				}
			}
		}
	}

	# Budget 2
	lesson_core_loop_2 = {
		text = "lesson_core_loop_2_desc"
		force_pause_game = yes
		highlight_widget = "income_and_expenses"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_0
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_3
		}
	}

	# Budget 3
	lesson_core_loop_3 = {
		text = "lesson_core_loop_3_desc"
		force_pause_game = yes
		highlight_widget = "tax_base"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_4
		}
	}

	# Budget 4
	lesson_core_loop_4 = {
		text = "lesson_core_loop_4_desc"
		force_pause_game = yes
		highlight_widget = "tax_slider"
		highlight_widget = "tax_automation"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_3
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_5
			enabled = {
				custom_tooltip = {
					text = "lesson_core_loop_automate_taxes"
					is_auto_raise_taxrate_for_all_estates = yes
				}
			}
		}
	}

	# Budget 5 (inflation)
	lesson_core_loop_5 = {
		text = "lesson_core_loop_5_desc"
		force_pause_game = yes
		highlight_widget = "mint_slider"
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_4
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_6
			enabled = {
				custom_tooltip = {
					text = "lesson_core_loop_minting"
					slider_minting_value > 0.05
				}
				custom_tooltip = {
					text = "lesson_core_loop_inflation"
					# modifier:monthly_inflation < 0.001 # doesn't work
					slider_minting_value < 0.25
				}
			}
		}
	}

	# Budget 6 (food and trade)
	lesson_core_loop_6 = {
		text = "lesson_core_loop_6_desc"
		force_pause_game = yes
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_4
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_7
		}
	}

	# Budget 7 (unpausing)
	lesson_core_loop_7 = {
		text = "lesson_core_loop_7_desc"
		highlight_widget = "date_section"
		force_pause_game = no
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_6
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_7b
			trigger = {
				custom_tooltip = {
					text = "lesson_core_loop_unpause_month"
					current_date > 1337.5.1
				}
			}
		}
	}

	# Budget 7b (unpausing done)
	lesson_core_loop_7b = {
		text = "lesson_core_loop_7b_desc"
		force_pause_game = yes
		pause_game = yes
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_6
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_8
		}
	}

	# Budget 8 (expenses)
	lesson_core_loop_8 = {
		text = "lesson_core_loop_8_desc"
		force_pause_game = yes
		highlight_widget = "expenses"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_7b
		}
		gui_transition = {
			button_id = "skip"
			button_text = "tutorial_lesson_button_skip"
			target = lesson_core_loop_9
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_core_loop_9
			enabled = {
				custom_tooltip = {
					text = "lesson_core_loop_positive_income"
					monthly_balance > 0 
				}
			}
		}
	}

	# Budget 9 (recap)
	lesson_core_loop_9 = {
		text = "lesson_core_loop_9_desc"
		force_pause_game = yes

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_8
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_estates_1
		}
	}


	# Estates 1
	lesson_estates_1 = {
		text = "lesson_estates_1_desc"
		force_pause_game = yes
		highlight_widget = "government_tab_button"
        highlight_widget = "tab_country"
        highlight_widget = "estates_tab"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_core_loop_9
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_estates_2
			enabled = {
				custom_tooltip = {
					text = "lesson_admin_open_government"
                    OR = {
                        is_widgetid_open = government_lateralview
                        is_widgetid_open = societal_values_lateralview
                        is_widgetid_open = mission_lateralview
                    }
				}
                custom_tooltip = {
                    text = "lesson_admin_open_country"
                    is_widgetid_open = "govinfo_intro"
                }
                custom_tooltip = {
                    text = "lesson_admin_open_estates"
                    is_widgetid_open = estates_area_intro
                }
			}
		}
	}

	# Estates 2
	lesson_estates_2 = {
		text = "lesson_estates_2_desc"
		force_pause_game = yes
		highlight_widget = "estates_area_intro"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_estates_1
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_estates_3
		}
	}

	# Estates 3
	lesson_estates_3 = {
		text = "lesson_estates_3_desc"
		force_pause_game = yes
		highlight_widget = "expenses"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_estates_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_estates_4
		}
	}
	
	# Estates 4 (privileges)
	lesson_estates_4 = {
		text = "lesson_estates_4_desc"
		force_pause_game = yes
		highlight_widget = "privileges"


		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_estates_3
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_estates_5
		}
	}

	# Estates 5 (social classes)
	lesson_estates_5 = {
		text = "lesson_estates_5_desc"
		force_pause_game = yes
		highlight_widget = "stat_population"
		highlight_widget = "estate_population"
		animation = center

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_estates_4
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_map_1
		}
	}

	# Map
	lesson_map_1 = {
		text = "lesson_map_1_desc"
		force_pause_game = yes
		animation = right

		shown_in_encyclopedia = no

		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_estates_5
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_map_2
			enabled = {
				custom_tooltip = {
					text = "lesson_trigger_zoom_out"
					is_camera_in_zoom_level = large
				}
				custom_tooltip = {
					text = "lesson_trigger_foreign_country"
					OR = {
						is_widgetid_open = diplomacy_lateralview
                        is_widgetid_open = diplomacy_macrobuilder_lateralview
						is_widgetid_open = foreign_country_lateralview
                    }
				}
			}
		}
		effect = {
			close_all_views = yes
		}
	}

	# Map
	lesson_map_2 = {
		text = "lesson_map_2_desc"
		force_pause_game = yes

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_map_1
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_map_3
			enabled = {
				custom_tooltip = {
					text = "lesson_trigger_zoom_in"
					is_camera_in_zoom_level = small
				}
			}
		}
		effect = {
			close_all_views = yes
		}
	}

	# Map
	lesson_map_3 = {
		text = "lesson_map_3_desc"
		force_pause_game = yes

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_map_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_control_groups_1
			enabled = {
				custom_tooltip = {
					text = "lesson_trigger_capital"
					is_widgetid_open = location_window_player_capital
				}
			}
		}
	}

	# Control Groups! Try them out...
	lesson_control_groups_1 = {
		text = "lesson_control_groups_1_desc"
		force_pause_game = yes
		highlight_widget = "control_groups"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_map_3
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_control_groups_2
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_click_map"
					OR = {
						is_widgetid_open = foreign_country_lateralview
						is_widgetid_open = location_window
						is_widgetid_open = intro_has_added_control_group
						has_global_variable = completed_control_groups
					}
				}
				custom_tooltip = {
					text = "lesson_basics_assign_control_group"
					OR = {
						is_widgetid_open = intro_has_added_control_group
						has_global_variable = completed_control_groups
					}
				}
			}
		}
		effect = {
			set_tutorial_var = intro_hide_ui_7
		}
	}

	# Control Groups - Complete!
	lesson_control_groups_2 = {
		text = "lesson_control_groups_2_desc"
		force_pause_game = yes

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_control_groups_1
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_location_1
		}
		effect = {
			set_global_variable = {
				name = completed_control_groups
				value = yes
			}
			set_tutorial_var = {
				name = intro_hide_ui_8
				value = 1
			}
		}
	}

	# Location 1
	lesson_location_1 = {
		text = "lesson_location_1_desc"
		force_pause_game = yes
		highlight_widget = "location_buildings"
		animation = center

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_control_groups_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_location_2
		}
	}

	# Location 2 (rgo)
	lesson_location_2 = {
		text = "lesson_location_2_desc"
		force_pause_game = yes
		highlight_widget = "location_rgo"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_location_1
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_location_3
		}
	}

	# Location 3 (tax_base)
	lesson_location_3 = {
		text = "lesson_location_3_desc"
		force_pause_game = yes
		highlight_widget = "location_tax_base"
		animation = right

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_location_2
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_location_3b
			trigger = {
				custom_tooltip = {
					text = "lesson_basics_click_map"
					OR = {
						is_widgetid_open = location_window
					}
				}
				custom_tooltip = {
					text = "lesson_basics_hover_tax_base"
					is_widgetid_open = location_tax_base_tooltip
				}
			}
		}
	}

	lesson_location_3b = {
		text = "lesson_location_3_desc"
		force_pause_game = yes
		highlight_widget = "location_tax_base"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_location_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_location_3_recap
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_click_map"
				}
				custom_tooltip = {
					text = "lesson_basics_hover_tax_base"
				}
			}
		}
	}

	lesson_location_3_recap = {
		text = "lesson_location_3_recap_desc"
		force_pause_game = yes
		animation = center

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_location_3
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_location_4
		}
	}

	# Location 4 (control)
	lesson_location_4 = {
		text = "lesson_location_4_desc"
		force_pause_game = yes
		highlight_widget = "location_control"
		animation = center

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_location_3_recap
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_location_5
		}
	}

	# Location 5 (proximity)
	lesson_location_5 = {
		text = "lesson_location_5_desc"
		force_pause_game = yes
		highlight_widget = "location_proximity"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_location_4
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_mapmodes_1
		}
	}

	# Mapmodes 1
	lesson_mapmodes_1 = {
		text = "lesson_mapmodes_1_desc"
		force_pause_game = yes
		highlight_widget = "location_control"
		highlight_widget = "control_tooltip_button"
		animation = right
		
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_location_5
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_mapmodes_1c
			trigger = {
				custom_tooltip = {
					text = "lesson_basics_control_mapmode"
					is_widgetid_open = location_control_tooltip_id
				}

				custom_tooltip = {
					text = "lesson_basics_control_mapmode_2"
					# current_tooltip_depth >= 2
					is_map_mode_active = "control"
					# is_widgetid_open = location_control_tooltip_id
					# is_map_mode_active = "control"
				}
			}
		}
	}

	lesson_mapmodes_1c = {
		text = "lesson_mapmodes_1_desc"
		force_pause_game = yes
		highlight_widget = "location_control"
		highlight_widget = "control_tooltip_button"
		animation = right
		
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_location_5
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_mapmodes_1b
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_control_mapmode"
				}

				custom_tooltip = {
					text = "lesson_basics_control_mapmode_2"
					is_map_mode_active = "control"
				}
			}
		}
	}

	lesson_mapmodes_1b = {
		text = "lesson_mapmodes_1b_desc"
		force_pause_game = yes
		highlight_widget = "location_control"
		highlight_widget = "control_tooltip_button"
		animation = right
		
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_mapmodes_1
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_mapmodes_2
		}
	}

	# Mapmodes 2 (proximity mapmode)
	lesson_mapmodes_2 = {
		text = "lesson_mapmodes_2_desc"
		force_pause_game = yes
		highlight_widget = "location_proximity"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_mapmodes_1
		}

		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_mapmodes_2a
			trigger = {
				custom_tooltip = {
					text = "lesson_basics_proximity_mapmode"
					OR = {
						is_widgetid_open = location_proximity_tooltip_id
						is_widgetid_open = location_proximity_tooltip_id2
					}					
				}

				custom_tooltip = {
					text = "lesson_basics_proximity_mapmode_2"
					is_map_mode_active = "proximity"
				}
			}
		}
	}
	lesson_mapmodes_2a = {
		text = "lesson_mapmodes_2_desc"
		force_pause_game = yes
		highlight_widget = "location_proximity"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_mapmodes_1
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_mapmodes_2b
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_proximity_mapmode"
				}

				custom_tooltip = {
					text = "lesson_basics_proximity_mapmode_2"
					is_map_mode_active = "proximity"
				}
			}
		}
	}

	lesson_mapmodes_2b = {
		text = "lesson_mapmodes_2b_desc"
		force_pause_game = yes
		# highlight_widget = "expenses"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_mapmodes_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_map_modes
		}
	}
	
	# Mapmodes 3
	lesson_basics_map_modes = {
		text = "lesson_basics_map_modes_desc"
		animation = right
		force_pause_game = yes
		highlight_widget = "mapmodes_collapsed_window"
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_mapmodes_2b
		}
		
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_map_modes_complete
			trigger = {
				custom_tooltip = {
					text = "lesson_basics_open_map_mode_widget"
					is_widgetid_open = mapmodes_window
				}
				custom_tooltip = {
					text = "lesson_basics_return_map_mode_widget"
					is_widgetid_open = mapmodes_window
				}
			}
		}

		effect = {
			set_tutorial_var = intro_hide_ui_1
		}
	}

	# Map modes - Done!
	lesson_basics_map_modes_complete = {
		text = "lesson_basics_map_modes_desc"
		animation = right
		force_pause_game = yes
		highlight_widget = "mapmodes_window"
		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_mapmodes_2b
		}

		gui_transition = {
			button_id = "repeat"
			button_text = "tutorial_lesson_button_repeat_step"
			target = lesson_basics_map_modes
		}

		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_road
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_open_map_mode_widget"
				}
				custom_tooltip = {
					text = "lesson_basics_return_map_mode_widget"
					is_map_mode_active = "terrain"
				}
			}
		}
	}

	# road 
	lesson_road = { 
		text = "lesson_road_desc"
		force_pause_game = yes
		highlight_widget = "location_road"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_map_modes
		}
		gui_transition = {
			button_id = "skip"
			button_text = "tutorial_lesson_button_skip"
			target = lesson_road_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_road_2
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_road1"
					OR = {
						is_widgetid_open = location_window_player_capital
						is_widgetid_open = road_builder_player_capital
					}
				}
				custom_tooltip = {
					text = "lesson_basics_road2"
					is_widgetid_open = road_builder_player_capital
				}
				custom_tooltip = {
					text = "lesson_basics_road3"
					capital = { has_road_constructions = yes }
				}
			}
		}
		effect = {
			capital = {
				market ?= {
					add_goods_supply = {
						goods = goods:sand
						amount = 100
					}
					add_goods_supply = {
						goods = goods:lumber
						amount = 100
					}
					add_goods_supply = {
						goods = goods:masonry
						amount = 100
					}
				}
			}
		}
	}

	# road b
	lesson_road_2 = { 
		text = "lesson_road_2_desc"
		force_pause_game = yes

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_road
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_road_3
		}
		effect = {
			close_all_views = yes
		}
	}

	lesson_road_3 = { 
		text = "lesson_road_3_desc"
		force_pause_game = yes

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_road_2
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_wrap_up_3
		}
		effect = {
			close_all_views = yes
		}
	}
	

	# Outliner and Context Menu!
	lesson_basics_wrap_up_3 = {
		text = "lesson_basics_wrap_up_3_desc"
		highlight_widget = "outliner_intro_uses_this"
		highlight_widget = "outliner_construction"
		force_pause_game = yes
		animation = left

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_road_3
		}
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_wrap_up_3b
			trigger = {
				custom_tooltip = {
					text = "lesson_basics_open_contextmenu"
					OR = {
						is_tooltip_with_name_open = CountryContextMenuDefault
						is_tooltip_with_name_open = LocationContextMenuDefault
						has_global_variable = completed_pin_intro
					}
				}
				custom_tooltip = {
					text = "lesson_basics_add_outliner"
					OR = {
						is_widgetid_open = fav_country_entry
						is_widgetid_open = fav_location_entry
						has_global_variable = completed_pin_intro
					}
				}
			}
		}
		effect = {
			set_tutorial_var = intro_hide_ui_8
			close_all_views = yes
		}
	}

	# You pinned something to the Outliner! Good job!
	lesson_basics_wrap_up_3b = {
		text = "lesson_basics_wrap_up_3_desc"
		highlight_widget = "outliner_intro_uses_this"
		highlight_widget = "outliner_construction"
		force_pause_game = yes
		animation = left

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_map_modes_complete
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_wrap_up_4
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_open_contextmenu"
				}
				custom_tooltip = {
					text = "lesson_basics_add_outliner"
				}
			}
		}

		effect = {
			set_global_variable = {
				name = completed_pin_intro
				value = yes
			}
		}
	}

	# Automation exists.... Open the panel!
	lesson_basics_wrap_up_4 = {
		text = "lesson_basics_wrap_up_4_desc"
		force_pause_game = yes
		highlight_widget = "button_automation"
		animation = center

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_wrap_up_3b
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_wrap_up_4b
		}
		trigger_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_wrap_up_4b
			trigger = {
				custom_tooltip = {
					text = "lesson_basics_open_automation_view"
					is_widgetid_open = automation_lateralview
				}
			}
		}
	}

	# More on automation!
	lesson_basics_wrap_up_4b = {
		text = "lesson_basics_wrap_up_4b_desc"
		force_pause_game = yes
		# highlight_widget = "button_automation"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_wrap_up_3b
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_wrap_up_5
		}
	}


	# There's also Alerts...
	lesson_basics_wrap_up_5 = {
		text = "lesson_basics_wrap_up_3b_desc"
		force_pause_game = yes
		highlight_widget = "alert_manager"

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_wrap_up_4
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_wrap_up_6
		}

		effect = {
			set_tutorial_var = intro_hide_ui_0
			close_all_views = yes
		}
	}

	#Agenda
	lesson_basics_wrap_up_6 = { 
		text = "lesson_basics_wrap_up_6_desc"
		highlight_widget = "agenda_button"
		force_pause_game = yes
		animation = left

		shown_in_encyclopedia = no
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_wrap_up_5
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_next"
			target = lesson_basics_final
			enabled = {
				custom_tooltip = {
					text = "lesson_basics_open_agenda"
					is_widgetid_open = "agenda_panel"
				}
			}
		}
		effect = {
			close_all_views = yes
		}
	}

	lesson_basics_final = {
		text = "lesson_basics_final_desc"
		shown_in_encyclopedia = no
		animation = center
		highlight_widget = "government_tab_button"
        highlight_widget = "tab_missions"
		highlight_widget = "button_adm_highlight"
		highlight_widget = "button_dip_highlight"
		highlight_widget = "button_mil_highlight"
	
		gui_transition = {
			button_id = "back"
			button_text = "tutorial_lesson_button_back"
			target = lesson_basics_wrap_up_6
		}
		gui_transition = {
			button_id = "next"
			button_text = "tutorial_lesson_button_complete_basics"
			target = lesson_finish # ends current lesson chain
			enabled = {
				custom_tooltip = {
					text = "lesson_admin_open_government"
                    OR = {
                        is_widgetid_open = government_lateralview
                        is_widgetid_open = societal_values_lateralview
                        is_widgetid_open = mission_lateralview
                    }
				}
                custom_tooltip = {
                    text = "lesson_admin_open_missions"
                    is_widgetid_open = "mission_lateralview"
                }
				custom_tooltip = {
                    text = "lesson_basics_mission_focus"
                    is_widgetid_open = "ABC" #This trigger is meant to always be false.
                }
			}
		}
		effect = {
			close_all_views = yes
		}

		# effect = {			
		# 	if = {
		# 		limit = {
		# 			is_player_playstyle = diplomatic
		# 		}
		# 		start_tutorial_lesson = lesson_diplomacy
		# 	}
		# 	else_if = {
		# 		limit = {
		# 			is_player_playstyle = administrative
		# 		}
		# 		start_tutorial_lesson = lesson_admin
		# 	}
		# 	else_if = {
		# 		limit = {
		# 			is_player_playstyle = military
		# 		}
		# 		start_tutorial_lesson = lesson_military
		# 	}
		# }
	}
}