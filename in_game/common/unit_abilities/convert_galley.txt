convert_galley_to_light_ship = {
	toggle = no
	navy_only = yes	
	map = yes
	confirm = yes
	
	hidden = {
		OR = {
			owner = {
				modifier:can_convert_galleys_to_light = no
			}
			NOT = { any_sub_unit = { sub_unit_category = sub_unit_category:navy_galley } }
		}
	}

	allow = {
		in_combat = no
		is_moving = no
		is_exiled = no		
		owner = {
			num_of_ports > 0
			can_build_units_of_category = sub_unit_category:navy_light_ship
			gold >= 5
		}
		unit_location = { 
			is_port = yes
			owner = root.owner
		}
		any_sub_unit = { sub_unit_category = sub_unit_category:navy_galley }
	}
	start_effect = {
		custom_tooltip = convert_galley_to_light_ship_effect
		save_scope_as = ship_unit
		while = {
			limit = {
				owner = {
					gold >= 5
				}
				any_sub_unit = {
					is_ship = yes
					sub_unit_category = sub_unit_category:navy_galley
				}
			}
			owner = { add_gold = -5 }
			random_sub_unit = {
				limit = {
					is_ship = yes
					sub_unit_category = sub_unit_category:navy_galley
				}
				scope:ship_unit = {
					unit_location = {
						create_sub_unit_of_category = sub_unit_category:navy_light_ship
					}
				}
				destroy_subunit = yes
			}
		}
	}
}

convert_light_ship_to_galley = {
	toggle = no
	navy_only = yes	
	map = yes
	confirm = yes
	
	hidden = {
		OR = {
			owner = {
				modifier:can_convert_galleys_to_light = no
			}
			NOT = { any_sub_unit = { sub_unit_category = sub_unit_category:navy_light_ship } }
		}
	}

	allow = {
		in_combat = no
		is_moving = no
		is_exiled = no		
		owner = {
			num_of_ports > 0
			can_build_units_of_category = sub_unit_category:navy_galley
			gold >= 5
		}		
		unit_location = { 
			is_port = yes
			owner = root.owner
		}
		any_sub_unit = { sub_unit_category = sub_unit_category:navy_light_ship }
	}
	start_effect = {
		custom_tooltip = convert_light_ship_to_galley_effect
		save_scope_as = ship_unit
		while = {
			limit = {
				owner = {
					gold >= 5
				}
				any_sub_unit = {
					is_ship = yes
					sub_unit_category = sub_unit_category:navy_light_ship
				}
			}
			owner = { add_gold = -5 }
			random_sub_unit = {
				limit = {
					is_ship = yes
					sub_unit_category = sub_unit_category:navy_light_ship
				}
				scope:ship_unit = {
					unit_location = {
						create_sub_unit_of_category = sub_unit_category:navy_galley
					}
				}
				destroy_subunit = yes
			}
		}
	}
}