hindu_branch = {
	has_target = no
	has_enemies = no
	unique = no
	expel_members_who_are_targets_of_other_members = no
	disband_if_no_leader = no
	custom_name = hindu_branch_name
	can_declare_war = {
		always = yes
	}
	
	variables = {
		#keep this as a var so it gets auto-added to the religion
		religion = {
			format = "RELIGION_FORMAT"
			start = religion:hindu
		}
	}
	
	create_visible_trigger = {
		always = no
	}

	invite_visible_trigger = {
		always = yes
	}

	can_lead_trigger = {
		always = yes
	}

	can_join_trigger = {
        religion = religion:hindu
	}
	
	can_leave_trigger = {
        #can't just leave. Can join a different one, but can't leave and not be in one.
		always = no
	}
	
	auto_leave_trigger = {
		always = no
	}

	auto_disband_trigger = {
		always = no
	}

	on_joined = {
		#make sure we get added to the religion
		scope:recipient = {
			var:religion = {
				add_international_organization = scope:recipient
			}
		}
        #can only be in one, so remove us from all the others
        every_international_organizations_member_of = {
            limit = {
                international_organization_type = international_organization_type:hindu_branch
                not = { this = scope:recipient }
            }
            remove_country_from_international_organization = {
				country = root
				reason = DecidedToLeave
			}
        }
		#Add gods for smartism
		if = {
			limit = {
				scope:recipient = {
					international_organization_has_policy = policy:smartism
				}
			}
			add_god = god:ganesha_god
			add_god = god:shiva_god
			add_god = god:shakti_god
			add_god = god:vishnu_god
			add_god = god:surya_god
		}
		#Activate first avatar for shaktism
		if = {
			limit = {
				scope:recipient = {
					international_organization_has_policy = policy:shaktism
				}
			}
			god:shakti_god = {
				random_avatar_for_god = {
					limit = {
						OR = {
							AND = {
								root = { at_war = no }
								is_peacetime_shakti_avatar = yes
							}
							is_wartime_shakti_avatar = yes
						}
					}
					root = { add_avatar = prev }
				}
			}
		}

	}

	on_left = {
		#Remove gods for smartism
		if = {
			limit = {
				scope:recipient = {
					international_organization_has_policy = policy:smartism
				}
			}
			remove_god = god:ganesha_god
			remove_god = god:shiva_god
			remove_god = god:shakti_god
			remove_god = god:vishnu_god
			remove_god = god:surya_god
			if = {
				limit = { has_variable = favoring_ganesha_god }
				remove_variable = favoring_ganesha_god
			}
			if = {
				limit = { has_variable = favoring_shiva_god }
				remove_variable = favoring_shiva_god
			}
			if = {
				limit = { has_variable = favoring_shakti_god }
				remove_variable = favoring_shakti_god
			}
			if = {
				limit = { has_variable = favoring_vishnu_god }
				remove_variable = favoring_vishnu_god
			}
			if = {
				limit = { has_variable = favoring_surya_god }
				remove_variable = favoring_surya_god
			}
		}
		#Remove any active avatar
		every_current_avatars = {
			root = { remove_avatar = prev }
		}
	}

	ai_desire_to_join = {
		#how useful is this branch?
		if = {
			limit = { exists = scope:target }
			add = {
				value = "scope:target.modifier_utility(scope:actor)"
			}
		}

		#if we're already in one, subtract the utility of the current one
		scope:actor = {
			#not in one? do it NOW!
			if = {
				limit = {
					not = {
						is_member_of_international_organization_of_type = { type = hindu_branch }
					}
				}
				add = 100
			}

			every_international_organizations_member_of = {
				limit = {
					international_organization_type = international_organization_type:hindu_branch
				}
				subtract = {
					value = "modifier_utility(scope:actor)"

					#inertia - if we're already in one then moving to another one must be significantly better
					add = 1
				}
			}
		}
	}
	
	ai_desire_to_allow_new_member = {
		add = {
			desc = "WE_WANT_THE_ORGANIZATION_TO_GROW"
			value = 20
		}
	}
}