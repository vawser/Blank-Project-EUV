the_revolution = {
	monthly_spawn_chance = monthly_spawn_chance_unique
	
	can_start = {
		current_age = age_6_revolutions
		any_great_power = {
			is_revolutionary = yes
		}
	}
	
	can_end = {
		the_revolution_end_trigger = yes
	}
	
	visible = {
		NOT = { country_type = pop }
		NOT = { country_type = building }
	}
	

	on_start = {
		ordered_revolutionary = {
			order_by = great_power_score
			max = 1 
			check_range_bounds = no
			set_revolution_target_effect = yes
		}
		every_country = {
			limit = {
				NOR = {
					is_subject_or_below_of = revolutionary_target
					revolutionary_target ?= { is_subject_or_below_of = prev }
				}
				OR = {
					is_revolution_target = yes
					is_neighbor_of = revolutionary_target
					is_great_power = yes
					AND = {
						is_human = yes
						NOT = { country_type = pop }
					}
				}
			}
			trigger_event_non_silently = the_revolution.1
		}
	}

	on_monthly = {
		ordered_great_power = {
			limit = { is_revolutionary = yes }   
			order_by = great_power_score
			max = 1 
			check_range_bounds = no
			set_revolution_target_effect = yes
		}
		every_country = {
			limit = { can_see_situation = root }
			random_list = {
				98 = { }
				1 = { trigger_event_silently = the_revolution.5 }
				1 = { trigger_event_silently = the_revolution.4 }
			}
			random_list = {
				99 = { }
				1 = { trigger_event_silently = the_revolution.6 }
			}

			random_list = {
				99 = { }
				1 = { trigger_event_silently = the_revolution.12 }
			}
		}
		if = {
			limit = { NOT = { has_variable = guillotine_event } }
			ordered_revolutionary = {
				order_by = num_of_advances_researched
				limit = { any_active_disaster = { disaster_type = disaster_type:revolutionary_chaos } }
				trigger_event_silently = the_revolution.7
			}
			set_variable = guillotine_event
		}
	}


	on_ended = {
		remove_variable = guillotine_event
		every_country = {
			remove_variable = rev_sit_parliament_event
			remove_variable = easier_rev_disaster
			trigger_event_non_silently = the_revolution.8
		}
	}

	tooltip = {
		if = {
			limit = {
				has_owner = yes
				owner ?= {
					revolutionary_target ?= this
				}
			}
			custom_tooltip = LEADER_OF_THE_REVOLUTION_TOOLTIP
		}
		else_if = {
			limit = {
				has_owner = yes
				owner = {
					any_active_disaster = {
						disaster_type = disaster_type:revolution_disaster
					}
				}
			}
			custom_tooltip = WRESTLING_WITH_THE_REVOLUTION_TOOLTIP
		}
		else_if = {
			limit = {
				owner ?= {
					any_enemy_war_leader = { 
						is_revolutionary = yes
						in_civil_war = yes
						is_rebel_country = yes
					}
				}
			}
			custom_tooltip = AT_WAR_WITH_REVOLUTIONARIES_TT
		}
		else_if = {
			limit = {
				owner ?= {
					is_revolutionary = yes
					any_current_war = {
						casus_belli ?= casus_belli:crush_the_revolution_cb
						defender_leader = prev
					}
				}
			}
			custom_tooltip = FIGHTING_AGAINST_COUNTER_REVOLUTIONARIES_TT
		}
		else_if = {
			limit = {
				owner ?= {
					is_revolutionary = no
					any_current_war = {
						casus_belli ?= casus_belli:crush_the_revolution_cb
						attacker_leader = prev
					}
				}
			}
			custom_tooltip = FIGHTING_AGAINST_REVOLUTIONARIES_TT
		}
		else_if = {
			limit = {
				owner ?= {
					is_revolutionary = yes
				}
			}
			custom_tooltip = IS_REVOLUTIONARY_TT
		}
	}

	map_color = {
		if = {
			limit = {
				owner ?= {
					revolutionary_target ?= this
				}
			}
			value = revolutionary_target.country_color
		}
		else_if = {
			limit = {
				owner ?= {
					any_enemy_war_leader = { 
						is_revolutionary = yes
						in_civil_war = yes
						is_rebel_country = yes
					}
				}
			}
			value = red
		}
		else_if = {
			limit = {
				owner ?= {
					is_revolutionary = yes
					any_current_war = {
						casus_belli ?= casus_belli:crush_the_revolution_cb
						defender_leader = prev
					}
				}
			}
			value = yellow
		}
		else_if = {
			limit = {
				owner ?= {
					is_revolutionary = no
					any_current_war = {
						casus_belli ?= casus_belli:crush_the_revolution_cb
						attacker_leader = prev
					}
				}
			}
			value = purple
		}
		else_if = {
			limit = {
				owner ?= {
					is_revolutionary = yes
				}
			}
			value = blue
		}
	}
	
	legend_key = { 
		desc = "[revolutionary_target|e]"
		color = revolutionary_target.country_color
		require_color_on_map = yes
	}
	legend_key = { 
		desc = "game_concept_coalition"
		color = red
		require_color_on_map = yes
	}
	legend_key = { 
		desc = "DEFENDER"
		color = yellow
		require_color_on_map = yes
	}
	legend_key = { 
		desc = "ATTACKER"
		color = purple
		require_color_on_map = yes
	}
	legend_key = { 
		desc = "[revolutionary|e]"
		color = blue
		require_color_on_map = yes
	}

	secondary_map_color = {
		if = {
			limit = {
				owner ?= {
					is_subject_of = revolutionary_target
				}
			}
			value = revolutionary_target.country_color
		}
	}
}