# Special buildings
template default_bridge {
	default_variables = {}
	code [[
		default_bridge = {
			order = 0
			size = bridge
			contributors = {
				always_one = 1.0
			}
			
			mesh_list = @mesh_list
		}
	]]
}

template under_construction_building {
	default_variables = {}
	code [[
		port = {
			order = 6
			contributors = {
				has_building_under_construction = 1.0
				has_rgo_under_construction = 1.0
	
				is_under_construction:castle = -1.0
				is_under_construction:fortress = -1.0
				is_under_construction:star_fort = -1.0
				is_under_construction:bastion = -1.0
				
				is_under_construction:naval_base = -1.0
				is_under_construction:grand_shipyard = 1.0
				is_under_construction:venetian_arsenal = -1.0
				is_under_construction:shipyard = -1.0
				is_under_construction:dry_dock = -1.0
				is_under_construction:ribeira_das_naus = -1.0
				is_under_construction:imperial_halic_shipyards = -1.0
				is_under_construction:copenhagen_dockyard = -1.0
				is_under_construction:barcelona_royal_shipyard = -1.0
				is_under_construction:royal_atarazanas_seville = -1.0
				is_under_construction:dry_dock = -1.0
				has_port_building_under_construction = -1.0
			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter
			weight_func = far_from_everything_weights
		}
	]]
}

template port {
	default_variables = {}
	code [[
		port = {
			order = 0
			contributors = {
				has_port = 1.0
			}
			mesh_list = port_meshes
			
			filter_func = special_port_filter
			weight_func = special_port_weights
		}
	]]
}

template dock {
	default_variables = {}
	code [[
		dock = {
			order = 1
			contributors = {
				has_port_building = 1.0
			}
			mesh_list = @mesh_list
			
			filter_func = special_port_filter
			weight_func = special_port_weights
		}
	]]
}
template dry_dock {
	default_variables = {}
	code [[
		dry_dock = {
			order = 2
			contributors = {
				has_building_with_at_least_one_level:dry_dock = 1.0
				has_building_with_at_least_one_level:ribeira_das_naus = 1.0
				has_building_with_at_least_one_level:imperial_halic_shipyards = 1.0
				has_building_with_at_least_one_level:copenhagen_dockyard = 1.0
				has_building_with_at_least_one_level:barcelona_royal_shipyard = 1.0
				has_building_with_at_least_one_level:royal_atarazanas_seville = 1.0
			}
			mesh_list = @mesh_list
			
			filter_func = special_port_filter
			weight_func = special_port_weights
		}
	]]
}
template shipyard {
	default_variables = {}
	code [[
		shipyard = {
			order = 3
			contributors = {
				has_building_with_at_least_one_level:shipyard = 1.0
				has_building_with_at_least_one_level:venetian_arsenal = 1.0
			}
			mesh_list = @mesh_list
			
			filter_func = special_port_filter
			weight_func = special_port_weights
		}
	]]
}
template grand_shipyard {
	default_variables = {}
	code [[
		grand_shipyard = {
			order = 4
			contributors = {
				has_building_with_at_least_one_level:grand_shipyard = 1.0
			}
			mesh_list = @mesh_list
			
			filter_func = special_port_filter
			weight_func = special_port_weights
		}
	]]
}
template naval_base {
	default_variables = {}
	code [[
		naval_base = {
			order = 5
			contributors = {
				has_building_with_at_least_one_level:naval_base = 1.0
			}
			mesh_list = @mesh_list
			
			filter_func = special_port_filter
			weight_func = special_port_weights
		}
	]]
}

template under_construction_port{
	default_variables = {}
	code [[
		naval_base = {
			order = 5
			contributors = {
				is_under_construction:naval_base = 1.0
				is_under_construction:grand_shipyard = 1.0
				is_under_construction:venetian_arsenal = 1.0
				is_under_construction:shipyard = 1.0
				is_under_construction:dry_dock = 1.0
				is_under_construction:ribeira_das_naus = 1.0
				is_under_construction:imperial_halic_shipyards = 1.0
				is_under_construction:copenhagen_dockyard = 1.0
				is_under_construction:barcelona_royal_shipyard = 1.0
				is_under_construction:royal_atarazanas_seville = 1.0
				is_under_construction:dry_dock = 1.0
				has_port_building_under_construction = 1.0
			}
			mesh_list = @mesh_list
			
			filter_func = special_port_filter
			weight_func = special_port_weights
		}
	]]
}

template seagulls {
	default_variables = {}
	code [[
		seagulls = {
			order = 6
			size = tiny
			contributors = { 
				always_one = 1.0
			}
			
			mesh_list = seagulls_meshes

			filter_func = next_to_tag
			filter_data = port
			weight_func = flat_weights
		}
	]]
}

#end of ports
#port order works backwards because of its different behaviour to the rest of the buildings 

template capital_flag {
	default_variables = {}
	code [[
		capital_flag = {
			order = 0
			size = tiny
			contributors = { 
				is_province_capital = 1.0
				has_building_with_at_least_one_level:stockade = -1.0
				has_building_with_at_least_one_level:castle = -1.0
				has_building_with_at_least_one_level:bastion = -1.0
				has_building_with_at_least_one_level:star_fort = -1.0
				has_building_with_at_least_one_level:fortress = -1.0
				is_under_construction:stockade = -1.0
				is_under_construction:castle = -1.0
				is_under_construction:bastion = -1.0
				is_under_construction:star_fort = -1.0
				is_under_construction:fortress = -1.0
			}
			
			mesh_list = capital_flag_meshes

			filter_func = center_tile_filter
			weight_func = flat_weights
		}
	]]
}

template capital_flag_fort {
	default_variables = {}
	code [[
		capital_flag = {
			order = 1
			size = tiny
			contributors = { 
				is_province_capital = 1.0
				has_building_with_at_least_one_level:stockade = 1.0
				has_building_with_at_least_one_level:castle = 1.0
				has_building_with_at_least_one_level:bastion = 1.0
				has_building_with_at_least_one_level:star_fort = 1.0
				has_building_with_at_least_one_level:fortress = 1.0
				is_under_construction:stockade = 1.0
				is_under_construction:castle = 1.0
				is_under_construction:bastion = 1.0
				is_under_construction:star_fort = 1.0
				is_under_construction:fortress = 1.0
			}
			
			mesh_list = capital_flag_meshes

			filter_func = into_tag
			filter_data = fort
			weight_func = flat_weights
		}
	]]
}


template stockade {
	default_variables = {mesh list = stockade_meshes}
	code [[
		stockade = {
			order = 0
			size = large
			contributors = { 
				has_building_with_at_least_one_level:stockade = 1.0
				has_building_with_at_least_one_level:castle = -1.0
				is_province_capital = -2.0
			}
			
			mesh_list = @mesh_list

			filter_func = closest_to_center_tile_filter
			weight_func = close_to_center_weights 

			allow_demote = no
			impostor_settings = fort_impostor_settings
		}
	]]
}

template stockade_no_flag {
	default_variables = {mesh list = stockade_no_flag_meshes}
	code [[
		stockade = {
			order = 0
			size = large
			contributors = { 
				has_building_with_at_least_one_level:stockade = 1.0
				has_building_with_at_least_one_level:castle = -1.0
			}

			required_contributors = {  is_province_capital = 1.0	}
			
			mesh_list = @mesh_list

			filter_func = closest_to_center_tile_filter
			weight_func = close_to_center_weights 

			allow_demote = no
			impostor_settings = fort_impostor_settings
		}
	]]
}

template fort {
	default_variables = {mesh_list = fort_meshes}
	code [[
		fort = {
			order = 0
			size = large
			contributors = { 
				has_building_with_at_least_one_level:castle = 1.0
			}
			
			mesh_list = @mesh_list

			filter_func = closest_to_center_tile_filter
			weight_func = close_to_center_weights 

			allow_demote = no
			impostor_settings = fort_impostor_settings
		}
	]]
}
template bastion {
	default_variables = {mesh_list = bastion_meshes}
	code [[
		bastion = {
			order = 0
			size = large
			contributors = { 
				has_building_with_at_least_one_level:bastion = 1.0
			}
			
			mesh_list = @mesh_list


			filter_func = closest_to_center_tile_filter
			weight_func = close_to_center_weights 

			allow_demote = no
			impostor_settings = fort_impostor_settings
		}
	]]
}

template starfort {
	default_variables = {mesh_list = starfort_meshes}
	code [[
		starfort = {
			order = 0
			size = large
			contributors = { 
				has_building_with_at_least_one_level:star_fort = 1.0
			}
			
			mesh_list = @mesh_list

			filter_func = closest_to_center_tile_filter
			weight_func = close_to_center_weights 

			allow_demote = no
			impostor_settings = fort_impostor_settings
		}
	]]
}

template fortress {
	default_variables = {mesh_list = fortress_meshes}
	code [[
		fortress = {
			order = 0
			size = large
			contributors = { 
				has_building_with_at_least_one_level:fortress = 1.0
			}
			
			mesh_list = @mesh_list

			filter_func = closest_to_center_tile_filter
			weight_func = close_to_center_weights 

			allow_demote = no
			impostor_settings = fort_impostor_settings
		}
	]]
}

template under_construction_fort {
	default_variables = {mesh_list = under_construction_fort_meshes}
	code [[
		under_construction_fort = {
			order = 1
			size = large
			contributors = { 
				is_under_construction:castle = 1.0
				is_under_construction:fortress = 1.0
				is_under_construction:star_fort = 1.0
				is_under_construction:bastion = 1.0
			}
			
			mesh_list = @mesh_list

			filter_func = closest_to_center_tile_filter
			weight_func = close_to_center_weights 

			allow_demote = no
			impostor_settings = fort_impostor_settings
		}
	]]
}

# Nobles
template center_building {
	default_variables = { 
		mesh_list = final_fallback_meshes
		scale = 1
		size = small
	}
	code [[
		center_building = {
			order = 2
			size = @size
			contributors = { is_dominant_culture_in_city = 1.0 }
			
			mesh_list = @mesh_list
			
			filter_func = closest_to_center_tile_filter
			weight_func = flat_weights

			location_filters = { rural_settlement = no }
			allow_demote = no

		}
	]]
}
template noble_seed {
	default_variables = { 
		mesh_list = final_fallback_meshes 
		scale = 1
		size = small
	}
	code [[
		noble_seed = {
			order = 2
			size = @size
			contributors = { 
				pop_count:nobles = @scale 
				pop_count:clergy = @scale 
			}
			
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter
			weight_func = close_to_center_weights
			
			allow_demote = no
			
			location_filters = { rural_settlement = no }
			
		}
	]]
}
template noble_neighborhood {
	default_variables = { 
		mesh_list = final_fallback_meshes 
		scale = 1
		size = small
	}
	code [[
		noble_neighborhood = {
			order = 3
			size = @size
			contributors = { 
				pop_count:nobles = @scale 
				pop_count:clergy = @scale
			}

			mesh_list = @mesh_list

			filter_func = seed_neighborhood_filter
			weight_func = grow_neighborhood_weights
			
			allow_demote = no
			
			location_filters = { rural_settlement = no }
			
		}
	]]
}

template nobles {
	default_variables = {}
	code [[
		load_template center_building {}
		load_template noble_seed {}
		#load_template noble_neighborhood {}
	]]
}


# Burghers
template burgher_center {
	default_variables = { 
		mesh_list = final_fallback_meshes 
		scale = 1
		size = small
	}
	code [[
		burgher_seed = {
			order = 6
			size = @size
			contributors = { pop_count:burghers = @scale }
			
			mesh_list = @mesh_list
			
			filter_func = closest_to_center_tile_filter
			weight_func = close_to_center_weights 
			
			allow_demote = no
			
			location_filters = { rural_settlement = no }
			
		}
	]]
}
template burgher_neighborhood {
	default_variables = { 
		mesh_list = final_fallback_meshes 
		scale = 7
		size = small
	}
	code [[
		burgher_neighborhood = {
			order = 7
			size = @size
			contributors = { pop_count:burghers = @[2.15 * scale] }
			
			mesh_list = @mesh_list

			filter_func = next_to_same_culture_filter  
			weight_func = grow_neighborhood_weights 
			
			allow_demote = yes
			
			location_filters = { rural_settlement = no }
			
		}
	]]
}
template burghers {
	default_variables = {}
	code [[
		load_template burgher_center {}
		load_template burgher_neighborhood {}
	]]
}

# Peasants
template peasant_neighborhood {
	default_variables = { 
		mesh_list = final_fallback_meshes
		scale = 1
		size = small
	}
	code [[
		peasant_neighborhood = {
			order = 10
			size = @size
			contributors = { 
				pop_count:peasants = @[0.15 * scale]
				pop_count:slaves = @[0.025 * scale]
			}

			mesh_list = @mesh_list

			filter_func = next_to_same_culture_filter 
			weight_func = grow_neighborhood_weights
			
			allow_promote = yes
			allow_demote = yes
			
			
			location_filters = { rural_settlement = no }
			
		}
	]]
}
template peasant_rural {
	default_variables = { 
		mesh_list = peasant_rural_meshes
		scale = 0.5
		size = small
	}
	code [[
		peasant_rural = {
			order = 8
			size = @size
			contributors = { 
				pop_count:peasants = @[0.15 * scale]
				pop_count:slaves = @[0.025 * scale]
			}

			mesh_list = @mesh_list

			filter_func = next_to_same_culture_filter 
			weight_func = grow_neighborhood_weights
			
			allow_promote = yes
			allow_demote = yes
			
			
			location_filters = { 
				city = no
				town = no
				rural_settlement = yes 
			}

			#impostor_settings = peasant_impostor_settings
		}

		peasant_rural_center = {
			order = 2
			size = @size
			contributors = { 
				pop_count:peasants = @[0.0 * scale]
				pop_count:slaves = @[0.00 * scale]
				always_one = 1
			}

			required_contributors = { 
				pop_count:peasants = @[0.05 * scale]
				pop_count:slaves = @[0.015 * scale]
			}
			mesh_list = @mesh_list

			filter_func = closest_to_center_tile_filter
			weight_func = close_to_center_weights 
			
			allow_promote = yes
			allow_demote = yes
			
			
			location_filters = { 
				city = no
				town = no
				rural_settlement = yes 
			}

			#impostor_settings = peasant_impostor_settings
		}
	]]
}

template peasants {
	default_variables = {}
	code [[
		load_template peasant_neighborhood {}
		load_template peasant_rural {}
	]]
}

# RGO
template rgo_generic {
	default_variables { 
		rgo_contributor = rgo_workers:wheat
		scale = 0.2
		mesh_list = mesh_list_farm
		size = small
		filter = next_to_same_culture_filter
	}
	code [[
		rgo_generic = {
			order = 30
			size = @size
			contributors = { @@rgo_contributor = @scale }

			mesh_list = @mesh_list

			filter_func = @filter  
			weight_func = close_to_center_weights 
			
			allow_promote = yes
			allow_demote = yes
		}
	]]
}

# Raw resources
template raw_resource {
	default_variables {
		contributor = raw_resources:wheat
		required_contributor =  always_one
		scale = 9
		mesh_list = raw_wheat_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 20
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = { @@required_contributor = 1}			
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter   
			weight_func = next_to_same_mesh_list_weights 
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}
template raw_resource_seed {
	default_variables {
		contributor = raw_resources:wheat
		required_contributor =  always_one
		scale = 9
		mesh_list = raw_wheat_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 19
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = { @@required_contributor = 1}			
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter   
			weight_func = far_from_everything_weights 
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}
template raw_resource_seeded {
	default_variables {
		contributor = raw_resources:wheat
		required_contributor =  always_one
		scale = 9
		mesh_list = raw_wheat_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 20
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = { @@required_contributor = 1}			
			mesh_list = @mesh_list
			
			filter_func = any_free_socket_filter   
			weight_func = next_to_same_mesh_list_weights_priorize_loneliness 
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}



# Raw resources
template lions {
	default_variables {
		contributor = continent:africa
		scale = 0.5
		mesh_list = lions_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 7
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {climate:arid = 0.5 vegetation:sparse = 0.5 subcontinent:north_africa = -1}			
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter   
			weight_func = far_from_everything_weights 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}
template lions_seeded {
	default_variables {
		contributor = subcontinent:west_africa
		scale = 3
		mesh_list = lions_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 8
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {climate:arid = 0.5 vegetation:sparse = 0.5}			
			mesh_list = @mesh_list
			
			filter_func = any_free_socket_filter   
			weight_func = next_to_same_mesh_list_weights_priorize_loneliness 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}

template platypus {
	default_variables {
		contributor = subcontinent:australasia
		scale = 1
		mesh_list = platypus_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 7
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {climate:oceanic = 0.5 climate:subtropical = 0.5 vegetation:forest = 0.5}			
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter   
			weight_func = far_from_everything_weights 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}

template platypus_seeded {
	default_variables {
		contributor = subcontinent:australasia
		scale = 2
		mesh_list = platypus_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 8
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {climate:oceanic = 0.5 climate:subtropical = 0.5 vegetation:forest = 0.5}			
			mesh_list = @mesh_list
			
			filter_func = any_free_socket_filter   
			weight_func = next_to_same_mesh_list_weights_priorize_loneliness 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}


template wolfs {
	default_variables {
		contributor = continent:europe
		scale = 1
		mesh_list = wolfs_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 7
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {vegetation:forest = 1}			
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter   
			weight_func = far_from_everything_weights 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}

template wolfs_seeded {
	default_variables {
		contributor = continent:europe
		scale = 3
		mesh_list = wolfs_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 8
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {vegetation:forest = 1}			
			mesh_list = @mesh_list
			
			filter_func = any_free_socket_filter   
			weight_func = next_to_same_mesh_list_weights_priorize_loneliness 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}

template bear {
	default_variables {
		contributor = subcontinent:north_america
		scale = 2
		mesh_list = bear_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 7
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {vegetation:forest = 1}			
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter   
			weight_func = far_from_everything_weights 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}

template bear_seeded {
	default_variables {
		contributor = subcontinent:north_america
		scale = 3
		mesh_list = bear_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 8
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {vegetation:forest = 1}			
			mesh_list = @mesh_list
			
			filter_func = any_free_socket_filter   
			weight_func = next_to_same_mesh_list_weights_priorize_loneliness 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}



template parrots {
	default_variables {
		contributor = continent:africa
		scale = 1
		mesh_list = parrots_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 7
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {climate:tropical = 0.5 vegetation:jungle = 0.5}			
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter 
			weight_func = next_to_same_mesh_list_weights
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}

template elk {
	default_variables {
		contributor = raw_resource:wild_game
		scale = 0.05
		mesh_list = elk_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 7
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {climate:arctic = 0.5 continent:europe = 0.5}			
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter   
			weight_func = next_to_same_mesh_list_weights 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}

template deer {
	default_variables {
		contributor = raw_resource:wild_game
		scale = 0.2
		mesh_list = raw_wild_game_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 19
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {climate:arctic = -1 continent:europe = 1}			
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter   
			weight_func = far_from_everything_weights 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}

template deer_seeded {
	default_variables {
		contributor = raw_resource:wild_game
		scale = 0.02
		mesh_list = raw_wild_game_mesh_list
		size = small
		can_build_over = yes
	}
	code [[
		raw_resource = {
			order = 20
			size = @size
			contributors = { @@contributor = @scale }
			required_contributors = {climate:arctic = -1 continent:europe = 1}			
			mesh_list = @mesh_list
			
			filter_func = any_free_socket_filter   
			weight_func = next_to_same_mesh_list_weights_priorize_loneliness 
			
			
			allow_demote = yes	# Other buildings can be placed on raw resources
			allow_promote = no
			allow_first_pass_replacement = @can_build_over # usually we only demote/promote if there's no good spot to put the new mesh. This enables promotion/demotion always
			can_grow_neighborhood = no #prevents buildings from counting this as a good "neighbor"
			permanent_replacement = yes #prevents this module from re-spawning a mesh after it has been demoted/promoted. E.g if we first spawn 10 "iron deposit" meshes, the rgo-module replaces 2 of them, it will still count as if 10 iron deposits exist
		}
	]]
}





template rgo_all {
	default_variables {
		mining_mesh_list 		= default_mining_mesh_list
		rice_mesh_list			= rice_mesh_list
		maize_mesh_list			= maize_mesh_list
		fiber_crops_mesh_list	= fiber_crops_mesh_list
		millet_mesh_list		= millet_mesh_list
		tea_mesh_list			= tea_mesh_list
		amber_mesh_list			= amber_mesh_list
		medicaments_mesh_list	= medicaments_mesh_list
		potato_mesh_list		= potato_mesh_list
		incense_mesh_list		= incense_mesh_list
		tobacco_mesh_list		= tobacco_mesh_list
		cocoa_mesh_list			= cocoa_mesh_list
		coffee_mesh_list		= coffee_mesh_list
		dyes_mesh_list			= dyes_mesh_list
		legumes_mesh_list		= legumes_mesh_list
		cotton_mesh_list		= cotton_mesh_list
		silk_mesh_list			= silk_mesh_list
		spices_mesh_list		= spices_mesh_list
		sugar_mesh_list			= sugar_mesh_list
		dates_mesh_list			= dates_mesh_list
		olives_mesh_list		= olives_mesh_list
		soybeans_mesh_list		= soybeans_mesh_list
		fruit_mesh_list			= fruit_mesh_list
		vine_mesh_list			= vine_mesh_list
		wheat_farming_mesh_list	= wheat_farming_mesh_list
		alum_mesh_list			= alum_mesh_list
		coal_mesh_list			= coal_mesh_list
		copper_mesh_list		= copper_mesh_list
		gems_mesh_list			= gems_mesh_list
		gold_mining_mesh_list	= gold_mining_mesh_list
		iron_mesh_list			= iron_mesh_list
		lead_mesh_list			= lead_mesh_list
		marble_mesh_list		= marble_mesh_list
		silver_mesh_list		= silver_mesh_list
		stone_mesh_list			= stone_mesh_list
		saltpeter_mesh_list		= saltpeter_mesh_list
		tin_mesh_list			= tin_mesh_list
		mercury_mesh_list		= mercury_mesh_list
		sand_mesh_list			= sand_mesh_list
		salt_mesh_list			= salt_mesh_list
		clay_mesh_list			= clay_mesh_list
		pearls_mesh_list		= pearls_mesh_list
		fish_mesh_list			= fish_mesh_list
		wool_mesh_list			= wool_mesh_list
		livestock_mesh_list		= livestock_mesh_list
		horses_mesh_list		= horses_mesh_list
		wild_game_mesh_list		= wild_game_mesh_list
		ivory_mesh_list			= ivory_mesh_list
		lumber_mesh_list		= lumber_mesh_list
		saffron_mesh_list		= saffron_mesh_list
		pepper_mesh_list		= pepper_mesh_list
		chili_mesh_list			= chili_mesh_list
		beeswax_mesh_list		= beeswax_mesh_list
		raw_turkey_mesh_list	= raw_turkey_mesh_list
		cloves_mesh_list		= cloves_mesh_list
		pork_livestock_override_meshlist = raw_livestock_mesh_list
	}
	code [[
	# "farming" rgos (gathered)

		load_template rgo_generic { rgo_contributor = rgo_workers:maize         mesh_list = @maize_mesh_list	filter = next_to_anything_filter 	scale = 3.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:millet        mesh_list = @millet_mesh_list 	scale = 2.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:rice          mesh_list = @rice_mesh_list 	filter = next_to_anything_filter	scale = 5.0 size = small can_build_over = no }
		load_template rgo_generic { rgo_contributor = rgo_workers:fiber_crops	mesh_list = @fiber_crops_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:tea			mesh_list = @tea_mesh_list 	scale = 2.0 can_build_over = no }
		load_template rgo_generic { rgo_contributor = rgo_workers:amber			mesh_list = @amber_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:medicaments   mesh_list = @medicaments_mesh_list 	scale = 2.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:potato	    mesh_list = @potato_mesh_list 	scale = 2.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:incense       mesh_list = @incense_mesh_list 	scale = 1.0 }		
		load_template rgo_generic { rgo_contributor = rgo_workers:tobacco       mesh_list = @tobacco_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:cocoa         mesh_list = @cocoa_mesh_list 	scale = 2.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:coffee        mesh_list = @coffee_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:dyes      	mesh_list = @dyes_mesh_list 	scale = 0.5 size = small  scale = 1 }
		load_template rgo_generic { rgo_contributor = rgo_workers:legumes      	mesh_list = @legumes_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:cotton        mesh_list = @cotton_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:silk      	mesh_list = @silk_mesh_list 	scale = 0.5 size = small scale = 1 }
		load_template rgo_generic { rgo_contributor = rgo_workers:pepper        mesh_list = @pepper_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:chili         mesh_list = @chili_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:saffron       mesh_list = @saffron_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:sugar			mesh_list = @sugar_mesh_list 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:olives        mesh_list = @olives_mesh_list 	scale = 2.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:fruit      	mesh_list = @fruit_mesh_list 	scale = 2.0 size = small  scale = 1 }
		load_template rgo_generic { rgo_contributor = rgo_workers:wine      	mesh_list = @vine_mesh_list 	scale = 2.0 size = small scale = 1 }
		load_template rgo_generic { rgo_contributor = rgo_workers:wheat			mesh_list = @wheat_farming_mesh_list 	scale = 3.0 size = small  }
		load_template rgo_generic { rgo_contributor = rgo_workers:cloves		mesh_list = @cloves_mesh_list 	scale = 3.0 size = small }

	
	# "mining" rgos
		load_template rgo_generic { rgo_contributor = rgo_workers:alum          mesh_list = @alum_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:coal			mesh_list = @coal_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:copper        mesh_list = @copper_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:gems          mesh_list = @gems_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:goods_gold    mesh_list = @gold_mining_mesh_list 	size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:iron			mesh_list = @iron_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:lead          mesh_list = @lead_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:marble        mesh_list = @marble_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:silver        mesh_list = @silver_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:stone			mesh_list = @stone_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:saltpeter     mesh_list = @saltpeter_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:tin           mesh_list = @tin_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:mercury     	mesh_list = @mercury_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:sand    		mesh_list = @sand_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:salt    		mesh_list = @salt_mesh_list 		size = small 	filter = replace_raw_resource_filter scale = 0.5}
		load_template rgo_generic { rgo_contributor = rgo_workers:clay     		mesh_list = @clay_mesh_list 	scale = 2.0 size = small filter = replace_raw_resource_filter scale = 1 }
		
	# misc
		load_template rgo_generic { rgo_contributor = rgo_workers:pearls		mesh_list = @pearls_mesh_list 	scale = 1.0 	filter = next_to_water_filter }
		load_template rgo_generic { rgo_contributor = rgo_workers:fish			mesh_list = @fish_mesh_list 	scale = 1.0		filter = next_to_water_filter }
		load_template rgo_generic { rgo_contributor = rgo_workers:wool			mesh_list = @wool_mesh_list	filter = next_to_anything_filter 	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:livestock		mesh_list = @livestock_mesh_list 	filter = closest_to_center_tile_filter  		scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:horses		mesh_list = @horses_mesh_list 	filter = next_to_anything_filter	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:wild_game		mesh_list = @wild_game_mesh_list filter = next_to_anything_filter	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:ivory			mesh_list = @ivory_mesh_list 	filter = next_to_anything_filter	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:lumber		mesh_list = @lumber_mesh_list	filter = next_to_anything_filter	scale = 1.0 }
		load_template rgo_generic { rgo_contributor = rgo_workers:beeswax		mesh_list = @beeswax_mesh_list 	filter = next_to_anything_filter	scale = 1.0 }

	


	# Raw resources (natural)

		#plants

		load_template raw_resource_seeded { contributor = raw_resource:millet			mesh_list = raw_millet_mesh_list		scale = 0.05	size = small }
		load_template raw_resource_seed { contributor = raw_resource:millet			mesh_list = raw_millet_mesh_list		scale = 0.01	size = small }
		load_template raw_resource_seeded { contributor = raw_resource:rice			mesh_list = raw_rice_mesh_list		scale = 0.03	size = small }
		load_template raw_resource_seed { contributor = raw_resource:rice			mesh_list = raw_rice_mesh_list		scale = 0.01	size = small }
		load_template raw_resource { contributor = raw_resource:fiber_crops		mesh_list = raw_fiber_crops_mesh_list 	scale = 0.05	size = small }
		load_template raw_resource_seeded { contributor = raw_resource:tea				mesh_list = raw_tea_mesh_list		scale = 0.10	size = small }
		load_template raw_resource_seed { contributor = raw_resource:tea				mesh_list = raw_tea_mesh_list		scale = 0.01	size = small }
		load_template raw_resource { contributor = raw_resource:amber			mesh_list = raw_amber_mesh_list		scale = 0.05	size = small }
		load_template raw_resource { contributor = raw_resource:medicaments	mesh_list = raw_medicaments_mesh_list		scale = 0.05	size = small }
		load_template raw_resource { contributor = raw_resource:potato			mesh_list = raw_potato_mesh_list		scale = 0.05	size = small }
		load_template raw_resource { contributor = raw_resource:incense			mesh_list = raw_incense_mesh_list			scale = 0.08	size = small }
		load_template raw_resource { contributor = raw_resource:tobacco			mesh_list = raw_tobacco_mesh_list			scale = 0.04	size = small can_build_over = no}
		load_template raw_resource { contributor = raw_resource:cocoa			mesh_list = raw_cocoa_mesh_list			scale = 0.05 	size = small	can_build_over = no}
		load_template raw_resource { contributor = raw_resource:coffee			mesh_list = raw_coffee_mesh_list			scale = 0.07	size = small }
		load_template raw_resource_seeded { contributor = raw_resource:dyes			mesh_list = raw_dyes_mesh_list			scale = 0.25 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:dyes			mesh_list = raw_dyes_mesh_list			scale = 0.05 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:legumes			mesh_list = raw_legumes_mesh_list			scale = 0.04	size = small can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:legumes			mesh_list = raw_legumes_mesh_list			scale = 0.02	size = small can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:cotton			mesh_list = raw_cotton_mesh_list			scale = 0.1	size = small can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:cotton 			mesh_list = raw_cotton_mesh_list 		scale = 0.02	size = small can_build_over = yes }
		load_template raw_resource_seeded { contributor = raw_resource:silk			mesh_list = raw_silk_mesh_list			scale = 0.07 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:silk			mesh_list = raw_silk_mesh_list			scale = 0.03 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:saffron			mesh_list = raw_saffron_mesh_list			scale = 0.03	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:saffron			mesh_list = raw_saffron_mesh_list			scale = 0.01	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:chili			mesh_list = raw_chili_mesh_list			scale = 0.06 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:chili			mesh_list = raw_chili_mesh_list			scale = 0.02 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:pepper			mesh_list = raw_pepper_mesh_list			scale = 0.4 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:pepper			mesh_list = raw_pepper_mesh_list			scale = 0.1 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:sugar			mesh_list = raw_sugar_mesh_list			scale = 0.1 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:sugar			mesh_list = raw_sugar_mesh_list			scale = 0.05 	size = small	can_build_over = no}	
		load_template raw_resource_seeded { contributor = raw_resource:olives			mesh_list = raw_olives_mesh_list			scale = 0.1 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:olives			mesh_list = raw_olives_mesh_list			scale = 0.05 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:fruit			mesh_list = raw_fruit_mesh_list			scale = 0.15	size = small }
		load_template raw_resource_seed { contributor = raw_resource:fruit			mesh_list = raw_fruit_mesh_list			scale = 0.05	size = small }
		load_template raw_resource_seeded { contributor = raw_resource:wine			mesh_list = raw_wine_mesh_list				scale = 0.03	size = small }
		load_template raw_resource_seed { contributor = raw_resource:wine			mesh_list = raw_wine_mesh_list				scale = 0.01	size = small }
		load_template raw_resource_seeded { contributor = raw_resource:wheat 			mesh_list = raw_wheat_mesh_list 		scale = 0.65	size = small can_build_over = yes }
		load_template raw_resource_seed { contributor = raw_resource:wheat 			mesh_list = raw_wheat_mesh_list 		scale = 0.05	size = small can_build_over = yes }
		load_template raw_resource { contributor = raw_resource:cloves 			mesh_list = raw_cloves_mesh_list 		scale = 0.05	size = small can_build_over = yes }
		
		#grounds

		load_template raw_resource_seeded { contributor = raw_resource:alum			mesh_list = raw_alum_mesh_list			scale = 0.03 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:alum			mesh_list = raw_alum_mesh_list			scale = 0.1	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:coal			mesh_list = raw_coal_mesh_list			scale = 0.01 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:coal			mesh_list = raw_coal_mesh_list			scale = 0.05	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:copper			mesh_list = raw_copper_mesh_list		scale = 0.1	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:copper			mesh_list = raw_copper_mesh_list			scale = 0.03	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:gems			mesh_list = raw_gems_mesh_list			scale = 0.1 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:gems			mesh_list = raw_gems_mesh_list			scale = 0.03	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:goods_gold		mesh_list = raw_goods_gold_mesh_list	scale = 0.1 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:goods_gold			mesh_list = raw_goods_gold_mesh_list			scale = 0.03	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:iron			mesh_list = raw_iron_mesh_list			scale = 0.03	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:iron			mesh_list = raw_iron_mesh_list			scale = 0.01 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:lead			mesh_list = raw_lead_mesh_list			scale = 0.03 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:lead		mesh_list = raw_lead_mesh_list			scale = 0.01	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:marble			mesh_list = raw_marble_mesh_list			scale = 0.03 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:marble			mesh_list = raw_marble_mesh_list			scale = 0.01	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:silver			mesh_list = raw_silver_mesh_list		scale = 0.03 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:silver			mesh_list = raw_silver_mesh_list			scale = 0.1	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:stone			mesh_list = raw_stone_mesh_list			scale = 0.03 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:stone			mesh_list = raw_stone_mesh_list			scale = 0.01	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:saltpeter		mesh_list = raw_saltpeter_mesh_list			scale = 0.03 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:saltpeter			mesh_list = raw_saltpeter_mesh_list			scale = 0.01	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:tin				mesh_list = raw_tin_mesh_list			scale = 0.02 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:tin			mesh_list = raw_tin_mesh_list			scale = 0.01	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:mercury			mesh_list = raw_mercury_mesh_list			scale = 0.02 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:mercury			mesh_list = raw_mercury_mesh_list			scale = 0.01	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:sand			mesh_list = raw_sand_mesh_list			scale = 0.04 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:sand			mesh_list = raw_sand_mesh_list			scale = 0.01	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:salt			mesh_list = raw_salt_mesh_list			scale = 0.03	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:salt			mesh_list = raw_salt_mesh_list			scale = 0.01	size = small	can_build_over = no}
		load_template raw_resource { contributor = raw_resource:clay			mesh_list = raw_clay_mesh_list			scale = 0.07 	size = small	can_build_over = no}




		#animals
		#load_template raw_resource { contributor = raw_resource:pearls			mesh_list = raw_pearls_mesh_list			scale = 0.02 	size = small	can_build_over = no  clear_map_objects = yes}
		#load_template raw_resource { contributor = raw_resource:fish			mesh_list = raw_fish_mesh_list			scale = 0.02 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:wool			required_contributor = continent:europe			mesh_list = raw_wool_mesh_list			scale = 0.02 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:wool			required_contributor = continent:europe			mesh_list = raw_wool_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:wool			required_contributor = continent:oceania			mesh_list = raw_wool_mesh_list			scale = 0.02 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:wool			required_contributor = continent:oceania			mesh_list = raw_wool_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:wool			required_contributor = continent:africa			mesh_list = raw_wool_mesh_list			scale = 0.02 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:wool			required_contributor = continent:africa			mesh_list = raw_wool_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:wool			required_contributor = continent:asia			mesh_list = raw_wool_mesh_list			scale = 0.02 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:wool			required_contributor = continent:asia			mesh_list = raw_wool_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:wool			required_contributor = continent:america		mesh_list = raw_llama_wool_mesh_list			scale = 0.02 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:wool			required_contributor = continent:america		mesh_list = raw_llama_wool_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:livestock		required_contributor = continent:europe		mesh_list = @pork_livestock_override_meshlist			scale = 0.03 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:livestock		required_contributor = continent:europe		mesh_list = @pork_livestock_override_meshlist			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:livestock		required_contributor = continent:asia		mesh_list = @pork_livestock_override_meshlist			scale = 0.15 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:livestock		required_contributor = continent:asia		mesh_list = @pork_livestock_override_meshlist			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:livestock		required_contributor = continent:africa		mesh_list = @pork_livestock_override_meshlist			scale = 0.15 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:livestock		required_contributor = continent:africa		mesh_list = @pork_livestock_override_meshlist			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:livestock		required_contributor = continent:oceania		mesh_list = @pork_livestock_override_meshlist			scale = 0.03 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:livestock		required_contributor = continent:oceania		mesh_list = @pork_livestock_override_meshlist			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:fur		required_contributor = continent:europe		mesh_list = raw_fur_mesh_list			scale = 0.15 	size = small	can_build_over = yes	}
		load_template raw_resource_seed { contributor = raw_resource:fur		required_contributor = continent:europe		mesh_list = raw_fur_mesh_list			scale = 0.1 	size = small	can_build_over = yes	}
		load_template raw_resource_seeded { contributor = raw_resource:fur		required_contributor = continent:asia		mesh_list = raw_fur_mesh_list			scale = 0.05	size = small	can_build_over = yes	}
		load_template raw_resource_seed { contributor = raw_resource:fur		required_contributor = continent:asia		mesh_list = raw_fur_mesh_list			scale = 0.02 	size = small	can_build_over = yes	}
		load_template raw_resource_seeded { contributor = raw_resource:fur		required_contributor = continent:america		mesh_list = raw_fur_mesh_list			scale = 0.05	size = small	can_build_over = yes	}
		load_template raw_resource_seed { contributor = raw_resource:fur		required_contributor = continent:america		mesh_list = raw_fur_mesh_list			scale = 0.02 	size = small	can_build_over = yes	}
		load_template raw_resource_seeded { contributor = raw_resource:livestock		required_contributor = continent:america	mesh_list = raw_turkey_mesh_list			scale = 0.05 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:livestock		required_contributor = continent:america	mesh_list = raw_turkey_mesh_list			scale = 0.02 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:horses			mesh_list = raw_horses_mesh_list			scale = 0.05 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:horses			mesh_list = raw_horses_mesh_list			scale = 0.01 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:wild_game		required_contributor = continent:asia	mesh_list = raw_wild_game_mesh_list			scale = 0.05 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:wild_game		required_contributor = continent:asia	mesh_list = raw_wild_game_mesh_list			scale = 0.02 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:wild_game		required_contributor = subcontinent:north_america	mesh_list = raw_wild_game_america_mesh_list			scale = 0.05 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:wild_game		required_contributor = subcontinent:north_america	mesh_list = raw_wild_game_america_mesh_list			scale = 0.02 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:wild_game		required_contributor = subcontinent:south_america	mesh_list = raw_wild_game_southamerica_mesh_list			scale = 0.05 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:wild_game		required_contributor = subcontinent:south_america	mesh_list = raw_wild_game_southamerica_mesh_list			scale = 0.02 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:wild_game		required_contributor = continent:africa		mesh_list = raw_wild_game_africa_mesh_list			scale = 0.02 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:wild_game		required_contributor = continent:oceania		mesh_list = raw_wild_game_oceania_mesh_list			scale = 0.05 	size = small	can_build_over = no}
		load_template raw_resource_seed { contributor = raw_resource:wild_game		required_contributor = continent:oceania		mesh_list = raw_wild_game_oceania_mesh_list			scale = 0.02 	size = small	can_build_over = no}
		load_template raw_resource_seeded { contributor = raw_resource:ivory			required_contributor = climate:continental 	mesh_list = raw_ivory_walrus_mesh_list			scale = 0.1 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:ivory			required_contributor = climate:continental 	mesh_list = raw_ivory_walrus_mesh_list			scale = 0.05 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:ivory			required_contributor = climate:arctic 	mesh_list = raw_ivory_walrus_mesh_list			scale = 0.1 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:ivory			required_contributor = climate:arctic 	mesh_list = raw_ivory_walrus_mesh_list			scale = 0.04 	size = small	can_build_over = yes}
		load_template raw_resource { contributor = raw_resource:ivory			required_contributor = climate:oceanic 	mesh_list = raw_ivory_walrus_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:ivory			required_contributor = climate:arid 	mesh_list = raw_ivory_elephant_mesh_list			scale = 0.05 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:ivory			required_contributor = climate:arid 	mesh_list = raw_ivory_elephant_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:ivory			required_contributor = climate:subtropical 	mesh_list = raw_ivory_elephant_mesh_list			scale = 0.05 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:ivory			required_contributor = climate:subtropical 	mesh_list = raw_ivory_elephant_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:ivory			required_contributor = climate:cold_arid 	mesh_list = raw_ivory_elephant_mesh_list			scale = 0.05 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:ivory			required_contributor = climate:cold_arid 	mesh_list = raw_ivory_elephant_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:ivory			required_contributor = climate:tropical 	mesh_list = raw_ivory_elephant_mesh_list			scale = 0.05 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:ivory			required_contributor = climate:tropical 	mesh_list = raw_ivory_elephant_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource { contributor = raw_resource:elephants		mesh_list = raw_elephant_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template raw_resource_seeded { contributor = raw_resource:beeswax			mesh_list = raw_beeswax_mesh_list			scale = 0.05 	size = small	can_build_over = yes}
		load_template raw_resource_seed { contributor = raw_resource:beeswax			mesh_list = raw_beeswax_mesh_list			scale = 0.01 	size = small	can_build_over = yes}
		load_template lions {}
		load_template lions_seeded {}
		load_template platypus {}
		load_template platypus_seeded {}
		load_template wolfs {}
		load_template wolfs_seeded {}
		load_template bear {}
		load_template bear_seeded {}
		load_template parrots {}
		load_template deer {}
		load_template elk {}
		#load_template raw_resource { contributor = raw_resource:lumber			mesh_list = raw_lumber_mesh_list		scale = 0.01 	size = small	can_build_over = no}

	]]
}

template factory {
	default_variables = {mesh_list = factory_meshes}
	code [[
		factory = {
			order = 8
			size = small
			contributors = { 
				has_building_with_at_least_one_level:glass_guild = 		0.2
				has_building_with_at_least_one_level:saltpeter_guild = 		0.2
				has_building_with_at_least_one_level:lacquerware_guild = 	0.2
				has_building_with_at_least_one_level:weapon_guild = 		0.2
				has_building_with_at_least_one_level:fine_cloth_guild = 	0.2
				has_building_with_at_least_one_level:cloth_guild = 			0.2
				has_building_with_at_least_one_level:jewelry_guild = 	0.2
				has_building_with_at_least_one_level:tannery = 				0.2
				has_building_with_at_least_one_level:paper_guild = 			0.2
				has_building_with_at_least_one_level:scriptorium = 			0.2
				has_building_with_at_least_one_level:tannery = 				0.2
				has_building_with_at_least_one_level:tools_guild = 		0.2
				has_building_with_at_least_one_level:distillers_guild = 	0.2
				has_building_with_at_least_one_level:brewery = 				0.2
				has_building_with_at_least_one_level:porcelain_guild = 	0.2
				has_building_with_at_least_one_level:naval_supplies_guild = 0.2
				has_building_with_at_least_one_level:hand_cannon_guild = 	0.2
			}
			
			mesh_list = @mesh_list

			filter_func = next_to_anything_filter
			weight_func = grow_neighborhood_weights 

			allow_demote = no
		}
	]]
}

template factory_tier_2 {
	default_variables = {mesh_list = factory_tier_2_meshes}
	code [[
		factory = {
			order = 8
			size = small
			contributors = { 
				has_building_with_at_least_one_level:distiller_manufactory = 		0.2
				has_building_with_at_least_one_level:brewery_manufactory = 		0.2
				has_building_with_at_least_one_level:winery_manufactory = 	0.2
				has_building_with_at_least_one_level:furniture_manufactory = 		0.2
				has_building_with_at_least_one_level:glassworks = 	0.2
				has_building_with_at_least_one_level:putrefaction_works = 			0.2
				has_building_with_at_least_one_level:naval_supplies_manufactory = 	0.2
				has_building_with_at_least_one_level:cannon_foundry = 				0.2
				has_building_with_at_least_one_level:firearms_manufactory = 			0.2
				has_building_with_at_least_one_level:weapon_manufactory = 			0.2
				has_building_with_at_least_one_level:fine_cloth_manufactory = 		0.2
				has_building_with_at_least_one_level:cloth_manufactory = 		0.2
				has_building_with_at_least_one_level:printing_press_shop = 			0.2
				has_building_with_at_least_one_level:perfumery = 	0.2
				has_building_with_at_least_one_level:porcelain_manufactory = 				0.2
				has_building_with_at_least_one_level:tannery_manufactory = 			0.2
				has_building_with_at_least_one_level:lacquerware_manufactory = 			0.2
				has_building_with_at_least_one_level:pottery_manufactory = 		0.2
			}
			
			mesh_list = @mesh_list

			filter_func = next_to_anything_filter
			weight_func = close_to_center_weights

			allow_demote = no
		}
	]]
}

template factory_tier_3 {
	default_variables = {mesh_list = factory_tier_3_meshes}
	code [[
		factory = {
			order = 8
			size = small
			contributors = { 
				has_building_with_at_least_one_level:fine_cloth_mill = 		0.2
				has_building_with_at_least_one_level:furniture_mill = 		0.2
				has_building_with_at_least_one_level:textile_mill = 	0.2
				has_building_with_at_least_one_level:steel_mill = 		0.2
				has_building_with_at_least_one_level:iron_foundry = 	0.2
				has_building_with_at_least_one_level:firearms_factory = 			0.2
				has_building_with_at_least_one_level:cannons_factory = 	0.2
				has_building_with_at_least_one_level:weapon_factory = 				0.2
			}
			
			mesh_list = @mesh_list

			filter_func = next_to_anything_filter
			weight_func = close_to_center_weights

			allow_demote = no
		}
	]]
}

template large_clergy {
	default_variables = {mesh_list = large_clergy_meshes}
	code [[
		large_clergy = {
			order = 1
			size = large
			contributors = {
				has_building_with_graphical_tag_and_at_least_one_level:large_religious = 1.0
			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter
			weight_func = close_to_center_weights
		}
	]]
}

template medium_clergy {
	default_variables = {mesh_list = medium_clergy_meshes}
	code [[
		medium_clergy = {
			order = 5
			size = small
			contributors = {
				has_building_with_graphical_tag_and_at_least_one_level:medium_religious = 1.0
			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter  
			weight_func = grow_neighborhood_weights 
		}
	]]
}

template small_clergy {
	default_variables = {mesh_list = small_clergy_meshes}
	code [[
		small_clergy = {
			order = 1
			size = small
			contributors = {
				has_building_with_graphical_tag_and_at_least_one_level:small_religious = 1.0
			}
			contributors = {
				has_building_with_at_least_one_level:parish_church = 1
				has_building_with_at_least_one_level:local_shrine = 1
				has_building_with_at_least_one_level:clerical_archives = 1
				has_building_with_at_least_one_level:spiritual_retreat = 1

			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter  
			weight_func = grow_neighborhood_weights 
		}
	]]
}

template market {
	default_variables = {mesh_list = market_meshes}
	code [[
		market = {
			order = 5
			size = small
			contributors = {
				has_building_with_at_least_one_level:local_markets = 1
				has_building_with_at_least_one_level:merchants_quarters = 1
				has_building_with_at_least_one_level:marketplace = 1
				has_building_with_at_least_one_level:market_village = 1
				has_building_with_at_least_one_level:port_authority = 1
				has_building_with_at_least_one_level:fondaco = 1
				has_building_with_at_least_one_level:slave_market = 1

			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter  
			weight_func = grow_neighborhood_weights 
		}
	]]
}

template peasants_gathering {
	default_variables = {mesh_list = peasants_gathering_meshes}
	code [[
		peasants_gathering = {
			order = 10
			size = small
			contributors = {
				has_building_with_at_least_one_level:peasants_training_grounds = 1
				has_building_with_at_least_one_level:festival_grounds = 1
				has_building_with_at_least_one_level:peasants_hunting_grounds = 1
				has_building_with_at_least_one_level:fishing_village = 1
				has_building_with_at_least_one_level:farming_village = 1
				has_building_with_at_least_one_level:forest_village = 1
				has_building_with_at_least_one_level:local_assembly = 1
				has_building_with_at_least_one_level:tar_kiln = 1
			}
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter        
			weight_func = next_to_same_mesh_list_weights_priorize_loneliness  
		}
	]]
}

template medium_military {
	default_variables = {mesh_list = medium_military_meshes}
	code [[
		medium_military = {
			order = 10
			size = small
			contributors = {
				has_building_with_at_least_one_level:admiralty = 1
				has_building_with_at_least_one_level:war_college = 1
				has_building_with_at_least_one_level:sergeantry = 1


			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter  
			weight_func = grow_neighborhood_weights  
		}
	]]
}

template culture {
	default_variables = {mesh_list = culture_meshes}
	code [[
		culture = {
			order = 3
			size = small
			contributors = {
				has_building_with_at_least_one_level:art_school = 1
				has_building_with_at_least_one_level:arts_academy = 1
				has_building_with_at_least_one_level:theater = 1


			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter  
			weight_func = grow_neighborhood_weights 
		}
	]]
}

template regimental_camp {
	default_variables = {mesh_list = regimental_camp_meshes}
	code [[
		regimental_camp = {
			order = 10
			size = large
			contributors = {
				has_building_with_at_least_one_level:regimental_camp = 1

			}
			mesh_list = @mesh_list
			
			filter_func = seed_neighborhood_filter   
			weight_func = next_to_same_mesh_list_weights_priorize_loneliness 
		}
	]]
}

template small_burgher {
	default_variables = {mesh_list = small_burgher_meshes}
	code [[
		small_burgher = {
			order = 4
			size = small
			contributors = {
				has_building_with_at_least_one_level:local_schools = 1
				has_building_with_at_least_one_level:local_newspaper = 1

			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter   
			weight_func = grow_neighborhood_weights 
		}
	]]
}

template medium_burgher {
	default_variables = {mesh_list = medium_burgher_meshes}
	code [[
		medium_burgher = {
			order = 0
			size = small
			contributors = {
				has_building_with_at_least_one_level:guild_hall = 1
				has_building_with_at_least_one_level:merchants_guild = 1
				has_building_with_at_least_one_level:artisan_guilds = 1
				has_building_with_at_least_one_level:slave_center = 1
				has_building_with_at_least_one_level:overseas_trading_post = 1
				has_building_with_at_least_one_level:entrepot = 1
				has_building_with_at_least_one_level:trading_hub = 1
				has_building_with_at_least_one_level:stock_exchange = 1
				has_building_with_at_least_one_level:clearing_house = 1
				has_building_with_at_least_one_level:caravan_stop = 1
				has_building_with_at_least_one_level:cinque_port = 1
				has_building_with_at_least_one_level:lieutenancy = 1
				has_building_with_at_least_one_level:viceroyalty = 1


			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter   
			weight_func = grow_neighborhood_weights
		}
	]]
}

template noble_military {
	default_variables = {mesh_list = noble_military_meshes}
	code [[
		noble_military = {
			order = 0
			size = small
			contributors = {
				has_building_with_at_least_one_level:toll_castle = 1
				has_building_with_at_least_one_level:nobility_fortifications = 1
				has_building_with_at_least_one_level:gallowglass_sept = 1
				has_building_with_at_least_one_level:peel_towers = 1
				has_building_with_at_least_one_level:dun_fort = 1

			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter   
			weight_func = grow_neighborhood_weights 
		}
	]]
}

template clergy_military {
	default_variables = {mesh_list = clergy_military_meshes}
	code [[
		clergy_military = {
			order = 0
			size = small
			contributors = {
				has_building_with_at_least_one_level:order_headquarters = 1
				has_building_with_at_least_one_level:warrior_temple = 1
				has_building_with_at_least_one_level:order_stronghold = 1
			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter   
			weight_func = grow_neighborhood_weights 
		}
	]]
}

template republican_assembly {
	default_variables = {mesh_list = republican_assembly_meshes}
	code [[
		republican_assembly = {
			order = 0
			size = large
			contributors = {
				has_building_with_at_least_one_level:republican_assembly = 1
			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter   
			weight_func = grow_neighborhood_weights
		}
	]]
}

template pirate_haven {
	default_variables = {mesh_list = pirate_haven_meshes}
	code [[
		pirate_haven = {
			order = 6
			size = small
			contributors = {
				has_building_with_at_least_one_level:pirate_haven = 1
			}
			mesh_list = @mesh_list
			
			filter_func = special_port_filter
			weight_func = special_port_weights
		}
	]]
}

template armory {
	default_variables = {mesh_list = armory_meshes}
	code [[
		armory = {
			order = 0
			size = small
			contributors = {
				has_building_with_at_least_one_level:armory = 1
			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter   
			weight_func = grow_neighborhood_weights 
		}
	]]
}

template barracks {
	default_variables = {mesh_list = barracks_meshes}
	code [[
		barracks = {
			order = 4
			size = small
			contributors = {
				has_building_with_at_least_one_level:barracks = 1
			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter   
			weight_func = grow_neighborhood_weights 
		}
	]]
}

template training_fields {
	default_variables = {mesh_list = training_fields_meshes}
	code [[
		training_fields = {
			order = 0
			size = small
			contributors = {
				has_building_with_at_least_one_level:training_fields = 1
			}
			mesh_list = @mesh_list
			
			filter_func = next_to_anything_filter   
			weight_func = grow_neighborhood_weights 
		}
	]]
}

##############################################
#unique_buildings
##############################################

# template haga_sophia
# {
# 	default_variables = 
# 	{
# 		mesh_list = haga_sofia_meshes
# 	}
# 	code = [[
# 		haga_sophia = {
# 			only_in_location = constantinople
# 			order = 0
# 			size = large
# 			limit = 
# 			{
# 				NOT = {
# 					has_global_variable = hagia_sophia_now_mosque
# 				}
# 			}
# 			mesh_list = @mesh_list
# 			contributors = 
# 			{
# 				always_one = 1.0
# 			}
# 			filter_func = seed_neighborhood_filter   
# 			weight_func = far_from_everything_weights 
# 		}
# 	]]	
# }

# template haga_sophia_mosque
# {
# 	default_variables = 
# 	{
# 		mesh_list = haga_sofia_mosque_meshes
# 	}
# 	code = [[
# 		haga_sophia = {
# 			only_in_location = constantinople
# 			order = 0
# 			size = large
# 			limit = 
# 			{
# 					has_global_variable = hagia_sophia_now_mosque
# 			}
# 			mesh_list = @mesh_list
# 			contributors = 
# 			{
# 				always_one = 1.0
# 			}
# 			filter_func = seed_neighborhood_filter   
# 			weight_func = far_from_everything_weights 
# 		}
# 	]]	
# }

template sitges_church
{
	default_variables = 
	{
		mesh_list = building_unique_sitges_church_mesh
		replace_meshes = @large_clergy_meshes
	}
	code = [[
		sitges_church = {
			only_in_location = sitges 
			order = 0
			size = large
			mesh_list = @mesh_list
			add_count_to_mesh_list = @replace_meshes
			contributors = 
			{
				has_building_with_graphical_tag_and_at_least_one_level:large_religious = 1.0
			}
			filter_func = center_tile_filter
			weight_func = close_to_center_weights 
		}
	]]	
}

template tre_kronor
{
	default_variables = 
	{
		mesh_list = tre_kronor_mesh
		replace_meshes_fort = fort_meshes
		replace_meshes_bastion = bastion_meshes 
	}
	code = [[
		tre_kronor = {
			only_in_location = stockholm 
			order = -1 
			size = large
			mesh_list = @mesh_list
			add_count_to_mesh_list = @replace_meshes_fort
			add_count_to_mesh_list = @replace_meshes_bastion
			contributors = 
			{	
				has_building_with_at_least_one_level:castle = 1.0
				has_building_with_at_least_one_level:bastion = 1.0
			}
			filter_func = center_tile_filter
			weight_func = close_to_center_weights 

			allow_demote = no
			impostor_settings = fort_impostor_settings
		}
	]]	
}


template unique_buildings
{
	default_variables = {
		large_clergy_meshes = large_clergy_meshes
		fort_meshes = fort_meshes
		bastion_meshes = bastion_meshes
	}
	code =
	[[
		# load_template = haga_sophia{}
		# load_template = haga_sophia_mosque{}
		load_template = sitges_church {replace_meshes = @large_clergy_meshes}
		load_template = tre_kronor 
		{
			replace_meshes_fort = fort_meshes
			replace_meshes_bastion = bastion_meshes
		}
	]]
}
template religius_buildings {
	default_variables={
		large_clergy_meshes = large_clergy_meshes
		medium_clergy_meshes = medium_clergy_meshes
		small_clergy_meshes = small_clergy_meshes
		clergy_military_meshes = clergy_military_meshes
	}
	code [[
		load_template large_clergy {mesh_list = @large_clergy_meshes}
		load_template medium_clergy {mesh_list = @medium_clergy_meshes}
		load_template small_clergy {mesh_list = @small_clergy_meshes}
		load_template clergy_military {mesh_list = @clergy_military_meshes}
	]]
}

template player_buildings {
	default_variables = 
	{
		stockade_meshes = stockade_meshes
		stockade_no_flag_meshes = stockade_no_flag_meshes
		fort_meshes = fort_meshes
		bastion_meshes = bastion_meshes
		starfort_meshes = starfort_meshes
		fortress_meshes = fortress_meshes
		factory_meshes = factory_meshes
		factory_tier_2_meshes = factory_tier_2_meshes
		factory_tier_3_meshes = factory_tier_3_meshes
		market_meshes = market_meshes
		peasants_gathering_meshes = peasants_gathering_meshes
		medium_military_meshes = medium_military_meshes
		culture_meshes = culture_meshes
		regimental_camp_meshes = regimental_camp_meshes
		small_burgher_meshes = small_burgher_meshes
		medium_burgher_meshes = medium_burgher_meshes
		noble_military_meshes = noble_military_meshes
		republican_assembly_meshes = republican_assembly_meshes
		pirate_haven_meshes = pirate_haven_meshes
		armory_meshes = armory_meshes
		barracks_meshes = barracks_meshes
		training_fields_meshes = training_fields_meshes
		dock_meshes = dock_meshes
		dry_dock_meshes = dry_dock_meshes
		shipyard_meshes = shipyard_meshes
		grand_shipyard_meshes = grand_shipyard_meshes
		naval_base_meshes = naval_base_meshes
		under_contruction_meshes = under_contruction_meshes
		under_construction_port_meshes = under_construction_port_meshes
		under_construction_fort_meshes = under_construction_fort_meshes
		default_bridge_meshes = default_bridge_meshes
	}
	code [[
		load_template capital_flag {}
		load_template seagulls {}
		load_template capital_flag_fort {}
		load_template port {}
		load_template default_bridge { mesh_list = @default_bridge_meshes}
		load_template fort {mesh_list = @fort_meshes}
		load_template bastion {mesh_list = @bastion_meshes}
		load_template starfort {mesh_list = @starfort_meshes}
		load_template fortress {mesh_list = @fortress_meshes}
		load_template stockade {mesh_list = @stockade_meshes}
		load_template stockade_no_flag {mesh_list = @stockade_no_flag_meshes}
		load_template dock {mesh_list = @dock_meshes}
		load_template dry_dock {mesh_list = @dry_dock_meshes}
		load_template shipyard {mesh_list = @shipyard_meshes}
		load_template grand_shipyard {mesh_list = @grand_shipyard_meshes}
		load_template naval_base {mesh_list = @naval_base_meshes}
		load_template factory {mesh_list = @factory_meshes}
		load_template factory_tier_2 {mesh_list = @factory_tier_2_meshes}
		load_template factory_tier_3 {mesh_list = @factory_tier_3_meshes}
		load_template market {mesh_list = @market_meshes}
		load_template peasants_gathering {mesh_list = @peasants_gathering_meshes}
		load_template medium_military {mesh_list = @medium_military_meshes}
		load_template culture {mesh_list = @culture_meshes}
		load_template regimental_camp {mesh_list = @regimental_camp_meshes}
		load_template small_burgher {mesh_list = @small_burgher_meshes}
		load_template medium_burgher {mesh_list = @medium_burgher_meshes}
		load_template noble_military {mesh_list = @noble_military_meshes}
		load_template republican_assembly {mesh_list = @republican_assembly_meshes}
		load_template pirate_haven {mesh_list = @pirate_haven_meshes}
		load_template armory {mesh_list = @armory_meshes}
		load_template barracks {mesh_list = @barracks_meshes}
		load_template training_fields {mesh_list = @training_fields_meshes}
		load_template under_construction_port {mesh_list = @under_construction_port_meshes}
		load_template under_construction_building {mesh_list = @under_contruction_meshes}
		load_template under_construction_fort {mesh_list = @under_construction_fort_meshes}
	]]
}

